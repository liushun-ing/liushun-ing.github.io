import{_ as a,o as s,c as e,a as n}from"./app-c1903e77.js";const i="/home/assets/image-20220508201203797-686d80ab.png",l="/home/assets/image-20220509210106327-283d386a.png",d="/home/assets/image-20220509210737877-dc7f681f.png",r="/home/assets/image-20220509211217522-d581d8fa.png",c={},t=n(`<h1 id="centos7安装mysql" tabindex="-1"><a class="header-anchor" href="#centos7安装mysql" aria-hidden="true">#</a> Centos7安装MySQL</h1><h3 id="_1-删除原有的数据库" tabindex="-1"><a class="header-anchor" href="#_1-删除原有的数据库" aria-hidden="true">#</a> 1 删除原有的数据库</h3><p>1、先彻底删除centos预装的mariadb，或者是卸载残留的MySQL</p><p>查看是否有mariadb</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">rpm</span> <span class="token parameter variable">-qa</span> <span class="token operator">|</span> <span class="token function">grep</span> mariadb
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>如果存在，就删除掉</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">rpm</span> <span class="token parameter variable">-e</span> <span class="token parameter variable">--nodeps</span> mariadb-libs-5.5.65-1.el7.x86_64　　
// 强力删除模式，连带删除依赖
// 这个需要看看是版本是不是对应
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>2、查询卸载的文件残留</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">find</span> / <span class="token parameter variable">-name</span> mysql
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>如果有，就删除</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">rm</span> <span class="token parameter variable">-rf</span> /usr/local/mysql
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="_2-下载安装包" tabindex="-1"><a class="header-anchor" href="#_2-下载安装包" aria-hidden="true">#</a> 2 下载安装包</h3><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">wget</span> https://downloads.mysql.com/archives/get/p/23/file/mysql-5.7.35-linux-glibc2.12-x86_64.tar.gz
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="_3-安装" tabindex="-1"><a class="header-anchor" href="#_3-安装" aria-hidden="true">#</a> 3 安装</h3><p>进入<code>/usr/local</code>目录，所以也可以一开始就进入这个目录去下载省事</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token builtin class-name">cd</span> /usr/local
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>解压</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">tar</span> <span class="token parameter variable">-zxvf</span> mysql-5.7.35-linux-glibc2.12-x86_64.tar.gz
// 可以用tar指令指定解压后的位置   j
<span class="token function">tar</span> <span class="token parameter variable">-zxvf</span> 所要解压的文件名 <span class="token parameter variable">-C</span> 解压位置
<span class="token function">tar</span> <span class="token parameter variable">-zxvf</span> mysql-5.7.35-linux-glibc2.12-x86_64.tar.gz <span class="token parameter variable">-C</span> /usr/local/
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>修改文件夹名字</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">mv</span> mysql-5.7.35-linux-glibc2.12-x86_64 mysql
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>进入<code>mysql</code>目录</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token builtin class-name">cd</span> mysql/
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>创建data文件夹</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">mkdir</span> data
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>添加mysql用户及用户组</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">groupadd</span> mysql
<span class="token function">useradd</span> <span class="token parameter variable">-r</span> <span class="token parameter variable">-g</span> mysql mysql
<span class="token function">chown</span> <span class="token parameter variable">-R</span> mysql.mysql /usr/local/mysql 
//将mysql文件夹授权给mysql用户和用户组
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>创建mysql配置文件</p><p>如果之前有这个文件，直接更改，如果没有就创建新的</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">vim</span> /etc/my.cnf
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>做如下配置</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token punctuation">[</span>mysqld<span class="token punctuation">]</span>
<span class="token assign-left variable">port</span><span class="token operator">=</span><span class="token number">3306</span>
<span class="token assign-left variable">basedir</span><span class="token operator">=</span>/usr/local/mysql
<span class="token assign-left variable">datadir</span><span class="token operator">=</span>/usr/local/mysql/data
symbolic-links<span class="token operator">=</span><span class="token number">0</span>
<span class="token assign-left variable">max_connections</span><span class="token operator">=</span><span class="token number">600</span>
default-time-zone<span class="token operator">=</span><span class="token string">&#39;+08:00&#39;</span>
<span class="token assign-left variable">character_set_server</span><span class="token operator">=</span>utf8
<span class="token assign-left variable">sql_mode</span><span class="token operator">=</span>STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>初始化mysql</p><p>先安装依赖</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>yum <span class="token function">install</span> libaio* <span class="token parameter variable">-y</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>开始初始化</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token builtin class-name">cd</span> /usr/local/mysql
./bin/mysqld <span class="token parameter variable">--initialize</span> <span class="token parameter variable">--user</span><span class="token operator">=</span>mysql <span class="token parameter variable">--basedir</span><span class="token operator">=</span>/usr/local/mysql <span class="token parameter variable">--datadir</span><span class="token operator">=</span>/usr/local/mysql/data
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><img src="`+i+`" alt="image-20220508201203797" style="zoom:80%;"><p>安装好后，会给一个初始化密码，记得保存下来</p><p>使用mysqld服务并设置开机启动</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">cp</span> support-files/mysql.server /etc/init.d/mysqld //添加mysqld服务
<span class="token function">chmod</span> <span class="token number">755</span> /etc/init.d/mysqld    //服务授权
<span class="token function">chkconfig</span> <span class="token parameter variable">--add</span> mysqld    //添加开机启动
<span class="token function">chkconfig</span> <span class="token parameter variable">--list</span>    //查看添加的开机启动服务
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>启动前检查配置</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">vim</span> /etc/init.d/mysqld

// 检查配置是否如下
<span class="token assign-left variable">basedir</span><span class="token operator">=</span>/usr/local/mysql
<span class="token assign-left variable">datadir</span><span class="token operator">=</span>/usr/local/mysql/data
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_4-启动服务" tabindex="-1"><a class="header-anchor" href="#_4-启动服务" aria-hidden="true">#</a> 4 启动服务</h3><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">service</span> mysqld start
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="_5-重置mysql密码并设置远程访问" tabindex="-1"><a class="header-anchor" href="#_5-重置mysql密码并设置远程访问" aria-hidden="true">#</a> 5 重置MySQL密码并设置远程访问</h3><p>进入<code>/usr/local/mysql/bin</code>目录，执行登陆命令</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>./mysql <span class="token parameter variable">-u</span> root <span class="token parameter variable">-p</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>输入上面保存的初始化密码</p><p>修改密码</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>alter user <span class="token string">&#39;root&#39;</span>@<span class="token string">&#39;localhost&#39;</span> identified by <span class="token string">&#39;你的密码&#39;</span><span class="token punctuation">;</span>
flush privileges<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>授权远程登陆</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>use mysql<span class="token punctuation">;</span>
GRANT ALL PRIVILEGES ON *.* TO root@<span class="token string">&quot;%&quot;</span> IDENTIFIED BY <span class="token string">&quot;你的密码&quot;</span><span class="token punctuation">;</span>
flush privileges<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>quit</code>指令退出后，重启一下服务器</p><h3 id="_6-相关命令" tabindex="-1"><a class="header-anchor" href="#_6-相关命令" aria-hidden="true">#</a> 6 相关命令</h3><p>重启</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>mysql <span class="token function">service</span> mysqld restart
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>启动</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>mysql <span class="token function">service</span> mysqld start
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>关闭</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>mysql <span class="token function">service</span> mysqld stop
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>查看运行状态</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">service</span> mysqld status
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="_7-配置环境变量" tabindex="-1"><a class="header-anchor" href="#_7-配置环境变量" aria-hidden="true">#</a> 7 配置环境变量</h3><p>编辑配置文件</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">vi</span> /etc/profile
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>在最后面加上</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token builtin class-name">export</span> <span class="token assign-left variable"><span class="token environment constant">PATH</span></span><span class="token operator">=</span><span class="token environment constant">$PATH</span>:/usr/local/mysql/bin
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>更新配置文件</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token builtin class-name">source</span> /etc/profile
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>之后就可以在任何地方使用mysql指令了</p><h3 id="_8-卸载mysql" tabindex="-1"><a class="header-anchor" href="#_8-卸载mysql" aria-hidden="true">#</a> 8 卸载mysql</h3><p>查找所有mysql文件</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">find</span> / <span class="token parameter variable">-name</span> mysql
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><img src="`+l+`" alt="image-20220509210106327" style="zoom:80%;"><p>依次删除这些文件即可</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">rm</span> <span class="token parameter variable">-rf</span> /etc/selinux/targeted/active/modules/100/mysql
<span class="token function">rm</span> <span class="token parameter variable">-rf</span> /usr/local/mysql
<span class="token function">rm</span> <span class="token parameter variable">-rf</span> /usr/local/bin/mysql
<span class="token function">rm</span> <span class="token parameter variable">-rf</span> /usr/lib64/mysql
// 还需要删除配置文件
<span class="token function">rm</span> <span class="token parameter variable">-rf</span> /etc/my.cnf
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>此时用yum工具也找不到了</p><img src="`+d+`" alt="image-20220509210737877" style="zoom:80%;"><p>完成</p><p>记得关闭一下他的开机自启动服务</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>systemctl disable mysqld.service
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><img src="`+r+`" alt="image-20220509211217522" style="zoom:80%;"><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>systemctl list-unit-files <span class="token operator">|</span> <span class="token function">grep</span> enabled
用这个检查是否g
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div>`,83),p=[t];function o(u,m){return s(),e("div",null,p)}const b=a(c,[["render",o],["__file","mysql_tutorial.html.vue"]]);export{b as default};
