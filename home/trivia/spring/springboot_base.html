<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.62">
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html, body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme');
			const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
			if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
				document.documentElement.classList.toggle('dark', true);
			}
    </script>
    <link rel="icon" href="/home/imgs/favicon.ico"><title>SpringBoot基础 | 不愿飞的蜂鸟首页</title><meta name="description" content="Five的垃圾库">
    <link rel="preload" href="/home/assets/style-d11d67ee.css" as="style"><link rel="stylesheet" href="/home/assets/style-d11d67ee.css">
    <link rel="modulepreload" href="/home/assets/app-00b5ba62.js"><link rel="modulepreload" href="/home/assets/springboot_base.html-bdb7e1f7.js"><link rel="modulepreload" href="/home/assets/springboot_base.html-e6d2a44d.js"><link rel="prefetch" href="/home/assets/index.html-572e34ff.js" as="script"><link rel="prefetch" href="/home/assets/index.html-81b2fcca.js" as="script"><link rel="prefetch" href="/home/assets/index.html-6f489083.js" as="script"><link rel="prefetch" href="/home/assets/index.html-25f3e375.js" as="script"><link rel="prefetch" href="/home/assets/index.html-7e831815.js" as="script"><link rel="prefetch" href="/home/assets/1.html-b316c5ed.js" as="script"><link rel="prefetch" href="/home/assets/2.html-ac2ea519.js" as="script"><link rel="prefetch" href="/home/assets/3.html-a16fc765.js" as="script"><link rel="prefetch" href="/home/assets/4.html-798018cd.js" as="script"><link rel="prefetch" href="/home/assets/5.html-18ce25f4.js" as="script"><link rel="prefetch" href="/home/assets/6.html-f31143bd.js" as="script"><link rel="prefetch" href="/home/assets/index.html-d4d6df4d.js" as="script"><link rel="prefetch" href="/home/assets/index.html-b98c27b4.js" as="script"><link rel="prefetch" href="/home/assets/algorithms.html-f5b5ee0a.js" as="script"><link rel="prefetch" href="/home/assets/c__.html-05ab7a9e.js" as="script"><link rel="prefetch" href="/home/assets/graph.html-dab7b16e.js" as="script"><link rel="prefetch" href="/home/assets/leetcode.html-f105e9f1.js" as="script"><link rel="prefetch" href="/home/assets/other_tree.html-22fe33b0.js" as="script"><link rel="prefetch" href="/home/assets/sort_and_search.html-11f53bfb.js" as="script"><link rel="prefetch" href="/home/assets/string.html-e9db3916.js" as="script"><link rel="prefetch" href="/home/assets/tree.html-ec32110e.js" as="script"><link rel="prefetch" href="/home/assets/1.html-99884eac.js" as="script"><link rel="prefetch" href="/home/assets/10.html-75dc6e9d.js" as="script"><link rel="prefetch" href="/home/assets/11.html-44ed8d03.js" as="script"><link rel="prefetch" href="/home/assets/12.html-1cafae42.js" as="script"><link rel="prefetch" href="/home/assets/13.html-cf9e5046.js" as="script"><link rel="prefetch" href="/home/assets/14.html-513b431e.js" as="script"><link rel="prefetch" href="/home/assets/2.html-094a87ee.js" as="script"><link rel="prefetch" href="/home/assets/3.html-4a8b2796.js" as="script"><link rel="prefetch" href="/home/assets/4.html-1f39f3b9.js" as="script"><link rel="prefetch" href="/home/assets/5.html-e78784fc.js" as="script"><link rel="prefetch" href="/home/assets/6.html-cc4acb22.js" as="script"><link rel="prefetch" href="/home/assets/7.html-ff096a2a.js" as="script"><link rel="prefetch" href="/home/assets/8.html-14b4319a.js" as="script"><link rel="prefetch" href="/home/assets/9.html-f1fd1f24.js" as="script"><link rel="prefetch" href="/home/assets/index.html-47fde470.js" as="script"><link rel="prefetch" href="/home/assets/1.html-769a7684.js" as="script"><link rel="prefetch" href="/home/assets/2.html-594984b8.js" as="script"><link rel="prefetch" href="/home/assets/3.html-5ac058a8.js" as="script"><link rel="prefetch" href="/home/assets/index.html-8a655167.js" as="script"><link rel="prefetch" href="/home/assets/index.html-994c7095.js" as="script"><link rel="prefetch" href="/home/assets/base_concept.html-8c9eb618.js" as="script"><link rel="prefetch" href="/home/assets/python_usage.html-6eb25c4d.js" as="script"><link rel="prefetch" href="/home/assets/pytorch_usage.html-12ebfb9e.js" as="script"><link rel="prefetch" href="/home/assets/index.html-35ebf264.js" as="script"><link rel="prefetch" href="/home/assets/gas_fee.html-ed17beee.js" as="script"><link rel="prefetch" href="/home/assets/monitoring.html-7dcd87e7.js" as="script"><link rel="prefetch" href="/home/assets/statedb_execute.html-39620858.js" as="script"><link rel="prefetch" href="/home/assets/23_Dec.html-b55b0d44.js" as="script"><link rel="prefetch" href="/home/assets/23_Nov.html-7f12af9c.js" as="script"><link rel="prefetch" href="/home/assets/24_Jan.html-aa29373f.js" as="script"><link rel="prefetch" href="/home/assets/index.html-cf670ace.js" as="script"><link rel="prefetch" href="/home/assets/index.html-e9115f16.js" as="script"><link rel="prefetch" href="/home/assets/compose.html-72dd1522.js" as="script"><link rel="prefetch" href="/home/assets/image_construct.html-803fa8bb.js" as="script"><link rel="prefetch" href="/home/assets/intro.html-c97d438d.js" as="script"><link rel="prefetch" href="/home/assets/framework.html-26732a5d.js" as="script"><link rel="prefetch" href="/home/assets/interview.html-c43e6b5a.js" as="script"><link rel="prefetch" href="/home/assets/javabase.html-4b7acc92.js" as="script"><link rel="prefetch" href="/home/assets/javacollection.html-7d0eec7c.js" as="script"><link rel="prefetch" href="/home/assets/javaio.html-2e0ce7a0.js" as="script"><link rel="prefetch" href="/home/assets/javajuc.html-e3adfcb3.js" as="script"><link rel="prefetch" href="/home/assets/project.html-ee5d4ecd.js" as="script"><link rel="prefetch" href="/home/assets/index.html-c00cd462.js" as="script"><link rel="prefetch" href="/home/assets/account.html-f2972d26.js" as="script"><link rel="prefetch" href="/home/assets/block.html-a9d64f7a.js" as="script"><link rel="prefetch" href="/home/assets/consensus.html-d4a4313d.js" as="script"><link rel="prefetch" href="/home/assets/contract.html-ebb9a32c.js" as="script"><link rel="prefetch" href="/home/assets/crypto_base.html-6226e31f.js" as="script"><link rel="prefetch" href="/home/assets/erc20.html-9175e857.js" as="script"><link rel="prefetch" href="/home/assets/ethereum_base.html-ed8afc4d.js" as="script"><link rel="prefetch" href="/home/assets/evm.html-c6aa4ef2.js" as="script"><link rel="prefetch" href="/home/assets/gas.html-7e483dbf.js" as="script"><link rel="prefetch" href="/home/assets/go_ethereum.html-7454bd3e.js" as="script"><link rel="prefetch" href="/home/assets/hd_wallet.html-3b70c8a3.js" as="script"><link rel="prefetch" href="/home/assets/jsonrpc.html-4b92012b.js" as="script"><link rel="prefetch" href="/home/assets/leveldb.html-f6dcddfb.js" as="script"><link rel="prefetch" href="/home/assets/mev.html-3b28f6dc.js" as="script"><link rel="prefetch" href="/home/assets/mpt.html-78685936.js" as="script"><link rel="prefetch" href="/home/assets/node_client.html-1945c0e1.js" as="script"><link rel="prefetch" href="/home/assets/rlp.html-c63951dd.js" as="script"><link rel="prefetch" href="/home/assets/statedb.html-57e0e0ee.js" as="script"><link rel="prefetch" href="/home/assets/transaction.html-ea80179c.js" as="script"><link rel="prefetch" href="/home/assets/index.html-737a4dbc.js" as="script"><link rel="prefetch" href="/home/assets/distributed.html-cb9755f7.js" as="script"><link rel="prefetch" href="/home/assets/gin.html-93f5f92b.js" as="script"><link rel="prefetch" href="/home/assets/gorm_1.html-c2cc8863.js" as="script"><link rel="prefetch" href="/home/assets/gorm_2.html-c9e371bb.js" as="script"><link rel="prefetch" href="/home/assets/goweb.html-dfefa78e.js" as="script"><link rel="prefetch" href="/home/assets/protobuf.html-46891574.js" as="script"><link rel="prefetch" href="/home/assets/rpc.html-2433bbc8.js" as="script"><link rel="prefetch" href="/home/assets/sse.html-86957496.js" as="script"><link rel="prefetch" href="/home/assets/test.html-0295cc69.js" as="script"><link rel="prefetch" href="/home/assets/websocket.html-2392370e.js" as="script"><link rel="prefetch" href="/home/assets/1.html-8f3c150c.js" as="script"><link rel="prefetch" href="/home/assets/2.html-35ec231b.js" as="script"><link rel="prefetch" href="/home/assets/3.html-5d7e2173.js" as="script"><link rel="prefetch" href="/home/assets/4.html-b019902a.js" as="script"><link rel="prefetch" href="/home/assets/index.html-dd915206.js" as="script"><link rel="prefetch" href="/home/assets/index.html-27666f68.js" as="script"><link rel="prefetch" href="/home/assets/dockerbase.html-359d1c8c.js" as="script"><link rel="prefetch" href="/home/assets/dockerutil.html-7ea89af6.js" as="script"><link rel="prefetch" href="/home/assets/k8sbase.html-dbb7e878.js" as="script"><link rel="prefetch" href="/home/assets/index.html-4918b69a.js" as="script"><link rel="prefetch" href="/home/assets/section0.html-0b462ef9.js" as="script"><link rel="prefetch" href="/home/assets/index.html-9e6553b4.js" as="script"><link rel="prefetch" href="/home/assets/mybatis.html-9fde4bbc.js" as="script"><link rel="prefetch" href="/home/assets/index.html-c33cb963.js" as="script"><link rel="prefetch" href="/home/assets/base.html-e757893c.js" as="script"><link rel="prefetch" href="/home/assets/progress_section_1.html-2fe43e44.js" as="script"><link rel="prefetch" href="/home/assets/progress_section_2.html-cbc863d5.js" as="script"><link rel="prefetch" href="/home/assets/progress_section_3.html-f33609b0.js" as="script"><link rel="prefetch" href="/home/assets/progress_section_4.html-979e5460.js" as="script"><link rel="prefetch" href="/home/assets/progress_section_5.html-e4a416a5.js" as="script"><link rel="prefetch" href="/home/assets/index.html-5b4a2fd2.js" as="script"><link rel="prefetch" href="/home/assets/alert.html-5d3a906c.js" as="script"><link rel="prefetch" href="/home/assets/clustering.html-1888741f.js" as="script"><link rel="prefetch" href="/home/assets/exporter.html-a7927412.js" as="script"><link rel="prefetch" href="/home/assets/intro.html-9b0b849c.js" as="script"><link rel="prefetch" href="/home/assets/promql.html-21c67535.js" as="script"><link rel="prefetch" href="/home/assets/servicediscovery.html-22fe93b7.js" as="script"><link rel="prefetch" href="/home/assets/index.html-5747b02b.js" as="script"><link rel="prefetch" href="/home/assets/base_usage.html-313edb82.js" as="script"><link rel="prefetch" href="/home/assets/1.html-84171baf.js" as="script"><link rel="prefetch" href="/home/assets/2.html-96474bc6.js" as="script"><link rel="prefetch" href="/home/assets/3.html-20b1a547.js" as="script"><link rel="prefetch" href="/home/assets/4.html-37db0907.js" as="script"><link rel="prefetch" href="/home/assets/index.html-9d407164.js" as="script"><link rel="prefetch" href="/home/assets/index.html-a2eab642.js" as="script"><link rel="prefetch" href="/home/assets/base.html-d1f2c2cd.js" as="script"><link rel="prefetch" href="/home/assets/progress.html-8a033067.js" as="script"><link rel="prefetch" href="/home/assets/script.html-15effd44.js" as="script"><link rel="prefetch" href="/home/assets/index.html-dbf7dd00.js" as="script"><link rel="prefetch" href="/home/assets/java_usage.html-baf8cd68.js" as="script"><link rel="prefetch" href="/home/assets/python_usage.html-5785b28e.js" as="script"><link rel="prefetch" href="/home/assets/system_usage.html-e9649787.js" as="script"><link rel="prefetch" href="/home/assets/index.html-1bcb2be9.js" as="script"><link rel="prefetch" href="/home/assets/docker_tutorial.html-4f5d0900.js" as="script"><link rel="prefetch" href="/home/assets/firewall_tutorial.html-a1c0f732.js" as="script"><link rel="prefetch" href="/home/assets/mysql_tutorial.html-4c6ba5d6.js" as="script"><link rel="prefetch" href="/home/assets/nginx_tutorial.html-93df5119.js" as="script"><link rel="prefetch" href="/home/assets/other_tutorial.html-c3d0505a.js" as="script"><link rel="prefetch" href="/home/assets/1.html-51f0ec55.js" as="script"><link rel="prefetch" href="/home/assets/2.html-a59bf622.js" as="script"><link rel="prefetch" href="/home/assets/index.html-b0e9f560.js" as="script"><link rel="prefetch" href="/home/assets/5.html-a4a0234f.js" as="script"><link rel="prefetch" href="/home/assets/6.html-d1f646bc.js" as="script"><link rel="prefetch" href="/home/assets/7.html-4bfc5de3.js" as="script"><link rel="prefetch" href="/home/assets/Mybatis.html-999b181b.js" as="script"><link rel="prefetch" href="/home/assets/index.html-3e3eac32.js" as="script"><link rel="prefetch" href="/home/assets/Spring.html-ebdaae63.js" as="script"><link rel="prefetch" href="/home/assets/SpringBoot.html-c1676d63.js" as="script"><link rel="prefetch" href="/home/assets/SpringMVC.html-7bf971fc.js" as="script"><link rel="prefetch" href="/home/assets/1.html-095f3a2d.js" as="script"><link rel="prefetch" href="/home/assets/2.html-820329b9.js" as="script"><link rel="prefetch" href="/home/assets/3.html-65fa04a9.js" as="script"><link rel="prefetch" href="/home/assets/4.html-6cc0fdbb.js" as="script"><link rel="prefetch" href="/home/assets/5.html-4382da55.js" as="script"><link rel="prefetch" href="/home/assets/index.html-2c443520.js" as="script"><link rel="prefetch" href="/home/assets/index.html-0a2a0106.js" as="script"><link rel="prefetch" href="/home/assets/less.html-26b18828.js" as="script"><link rel="prefetch" href="/home/assets/sass.html-e33a9ecf.js" as="script"><link rel="prefetch" href="/home/assets/1.html-e6ed9dbf.js" as="script"><link rel="prefetch" href="/home/assets/2.html-76ba2e41.js" as="script"><link rel="prefetch" href="/home/assets/index.html-202d5f4b.js" as="script"><link rel="prefetch" href="/home/assets/1.html-c051337a.js" as="script"><link rel="prefetch" href="/home/assets/2.html-c475ae33.js" as="script"><link rel="prefetch" href="/home/assets/index.html-7a9eb86e.js" as="script"><link rel="prefetch" href="/home/assets/1.html-2d63875b.js" as="script"><link rel="prefetch" href="/home/assets/2.html-96ffe2d7.js" as="script"><link rel="prefetch" href="/home/assets/3.html-164f28d8.js" as="script"><link rel="prefetch" href="/home/assets/4.html-770067b7.js" as="script"><link rel="prefetch" href="/home/assets/5.html-94e4a58f.js" as="script"><link rel="prefetch" href="/home/assets/6.html-5fbe2511.js" as="script"><link rel="prefetch" href="/home/assets/7.html-6aaf4692.js" as="script"><link rel="prefetch" href="/home/assets/8.html-6c442319.js" as="script"><link rel="prefetch" href="/home/assets/9.html-1a1241a0.js" as="script"><link rel="prefetch" href="/home/assets/index.html-ca14f1ca.js" as="script"><link rel="prefetch" href="/home/assets/new.html-f39ecd3a.js" as="script"><link rel="prefetch" href="/home/assets/1.html-f45e37f8.js" as="script"><link rel="prefetch" href="/home/assets/index.html-3b81aa58.js" as="script"><link rel="prefetch" href="/home/assets/index.html-3505c412.js" as="script"><link rel="prefetch" href="/home/assets/uniCloud.html-d6f4a4e6.js" as="script"><link rel="prefetch" href="/home/assets/uniTips.html-c522b2d1.js" as="script"><link rel="prefetch" href="/home/assets/1.html-3be78b60.js" as="script"><link rel="prefetch" href="/home/assets/index.html-6602172a.js" as="script"><link rel="prefetch" href="/home/assets/index.html-dcc009ab.js" as="script"><link rel="prefetch" href="/home/assets/api_tutorial.html-201e8b68.js" as="script"><link rel="prefetch" href="/home/assets/base_tutorial.html-553e9cd8.js" as="script"><link rel="prefetch" href="/home/assets/pinia.html-93944f84.js" as="script"><link rel="prefetch" href="/home/assets/vue2.html-396e5caf.js" as="script"><link rel="prefetch" href="/home/assets/vue3_1.html-a3f127a4.js" as="script"><link rel="prefetch" href="/home/assets/vue3_2.html-52a41818.js" as="script"><link rel="prefetch" href="/home/assets/1.html-6b5b0d34.js" as="script"><link rel="prefetch" href="/home/assets/index.html-f9a24ca8.js" as="script"><link rel="prefetch" href="/home/assets/1.html-a99eaaf4.js" as="script"><link rel="prefetch" href="/home/assets/index.html-17ad9c14.js" as="script"><link rel="prefetch" href="/home/assets/1.html-039b4262.js" as="script"><link rel="prefetch" href="/home/assets/2.html-42769e2a.js" as="script"><link rel="prefetch" href="/home/assets/index.html-25191acb.js" as="script"><link rel="prefetch" href="/home/assets/index.html-bf41a08e.js" as="script"><link rel="prefetch" href="/home/assets/jwt.html-3b7c50b6.js" as="script"><link rel="prefetch" href="/home/assets/shiro.html-342768e3.js" as="script"><link rel="prefetch" href="/home/assets/index.html-5427bf36.js" as="script"><link rel="prefetch" href="/home/assets/nacos.html-9e867259.js" as="script"><link rel="prefetch" href="/home/assets/index.html-48e4d448.js" as="script"><link rel="prefetch" href="/home/assets/spring_annotation.html-9fe17a51.js" as="script"><link rel="prefetch" href="/home/assets/springboot.html-5ae0091a.js" as="script"><link rel="prefetch" href="/home/assets/404.html-f9875e7b.js" as="script"><link rel="prefetch" href="/home/assets/index.html-3a9cff4c.js" as="script"><link rel="prefetch" href="/home/assets/index.html-f27d80fd.js" as="script"><link rel="prefetch" href="/home/assets/index.html-3907d885.js" as="script"><link rel="prefetch" href="/home/assets/index.html-87e67864.js" as="script"><link rel="prefetch" href="/home/assets/index.html-be05238a.js" as="script"><link rel="prefetch" href="/home/assets/1.html-dd65d9c8.js" as="script"><link rel="prefetch" href="/home/assets/2.html-21793f3d.js" as="script"><link rel="prefetch" href="/home/assets/3.html-8b6aff2f.js" as="script"><link rel="prefetch" href="/home/assets/4.html-041a7b80.js" as="script"><link rel="prefetch" href="/home/assets/5.html-2c986e6a.js" as="script"><link rel="prefetch" href="/home/assets/6.html-515b80f9.js" as="script"><link rel="prefetch" href="/home/assets/index.html-e3157f36.js" as="script"><link rel="prefetch" href="/home/assets/index.html-edd96ce3.js" as="script"><link rel="prefetch" href="/home/assets/algorithms.html-577c7473.js" as="script"><link rel="prefetch" href="/home/assets/c__.html-6f3a082b.js" as="script"><link rel="prefetch" href="/home/assets/graph.html-54861f6b.js" as="script"><link rel="prefetch" href="/home/assets/leetcode.html-963ad6b5.js" as="script"><link rel="prefetch" href="/home/assets/other_tree.html-1174ec6b.js" as="script"><link rel="prefetch" href="/home/assets/sort_and_search.html-da9c2916.js" as="script"><link rel="prefetch" href="/home/assets/string.html-469ac760.js" as="script"><link rel="prefetch" href="/home/assets/tree.html-bc50aa04.js" as="script"><link rel="prefetch" href="/home/assets/1.html-01c90588.js" as="script"><link rel="prefetch" href="/home/assets/10.html-7c14cfb8.js" as="script"><link rel="prefetch" href="/home/assets/11.html-b9fcbc68.js" as="script"><link rel="prefetch" href="/home/assets/12.html-682e4c91.js" as="script"><link rel="prefetch" href="/home/assets/13.html-0e288a8f.js" as="script"><link rel="prefetch" href="/home/assets/14.html-9c806adf.js" as="script"><link rel="prefetch" href="/home/assets/2.html-d083cc8a.js" as="script"><link rel="prefetch" href="/home/assets/3.html-8955e375.js" as="script"><link rel="prefetch" href="/home/assets/4.html-94ef0a88.js" as="script"><link rel="prefetch" href="/home/assets/5.html-73ad9681.js" as="script"><link rel="prefetch" href="/home/assets/6.html-c67af00e.js" as="script"><link rel="prefetch" href="/home/assets/7.html-517e7d86.js" as="script"><link rel="prefetch" href="/home/assets/8.html-94a98dfc.js" as="script"><link rel="prefetch" href="/home/assets/9.html-20753ff6.js" as="script"><link rel="prefetch" href="/home/assets/index.html-f6c0a813.js" as="script"><link rel="prefetch" href="/home/assets/1.html-d5d64317.js" as="script"><link rel="prefetch" href="/home/assets/2.html-f30a9e89.js" as="script"><link rel="prefetch" href="/home/assets/3.html-11454a36.js" as="script"><link rel="prefetch" href="/home/assets/index.html-d4c29795.js" as="script"><link rel="prefetch" href="/home/assets/index.html-e4d10af0.js" as="script"><link rel="prefetch" href="/home/assets/base_concept.html-f07d3e35.js" as="script"><link rel="prefetch" href="/home/assets/python_usage.html-6f659fe0.js" as="script"><link rel="prefetch" href="/home/assets/pytorch_usage.html-71b3897b.js" as="script"><link rel="prefetch" href="/home/assets/index.html-17708a1d.js" as="script"><link rel="prefetch" href="/home/assets/gas_fee.html-ff2546bd.js" as="script"><link rel="prefetch" href="/home/assets/monitoring.html-3608615a.js" as="script"><link rel="prefetch" href="/home/assets/statedb_execute.html-586a8310.js" as="script"><link rel="prefetch" href="/home/assets/23_Dec.html-df8e689f.js" as="script"><link rel="prefetch" href="/home/assets/23_Nov.html-b4d85892.js" as="script"><link rel="prefetch" href="/home/assets/24_Jan.html-c2926e81.js" as="script"><link rel="prefetch" href="/home/assets/index.html-4d686151.js" as="script"><link rel="prefetch" href="/home/assets/index.html-c9b4ce3e.js" as="script"><link rel="prefetch" href="/home/assets/compose.html-063b36ef.js" as="script"><link rel="prefetch" href="/home/assets/image_construct.html-169586e3.js" as="script"><link rel="prefetch" href="/home/assets/intro.html-a2adbcc1.js" as="script"><link rel="prefetch" href="/home/assets/framework.html-2e1be613.js" as="script"><link rel="prefetch" href="/home/assets/interview.html-a2fa3909.js" as="script"><link rel="prefetch" href="/home/assets/javabase.html-51aaba84.js" as="script"><link rel="prefetch" href="/home/assets/javacollection.html-67ff16cd.js" as="script"><link rel="prefetch" href="/home/assets/javaio.html-6c01230d.js" as="script"><link rel="prefetch" href="/home/assets/javajuc.html-0fd75f3e.js" as="script"><link rel="prefetch" href="/home/assets/project.html-98e4ae3e.js" as="script"><link rel="prefetch" href="/home/assets/index.html-cbe70948.js" as="script"><link rel="prefetch" href="/home/assets/account.html-850e0166.js" as="script"><link rel="prefetch" href="/home/assets/block.html-d591f451.js" as="script"><link rel="prefetch" href="/home/assets/consensus.html-a1f4b5f3.js" as="script"><link rel="prefetch" href="/home/assets/contract.html-e3a5102a.js" as="script"><link rel="prefetch" href="/home/assets/crypto_base.html-61b42633.js" as="script"><link rel="prefetch" href="/home/assets/erc20.html-172b8b55.js" as="script"><link rel="prefetch" href="/home/assets/ethereum_base.html-08bef84d.js" as="script"><link rel="prefetch" href="/home/assets/evm.html-d18e5229.js" as="script"><link rel="prefetch" href="/home/assets/gas.html-a56cfbad.js" as="script"><link rel="prefetch" href="/home/assets/go_ethereum.html-77b4a18d.js" as="script"><link rel="prefetch" href="/home/assets/hd_wallet.html-5de95233.js" as="script"><link rel="prefetch" href="/home/assets/jsonrpc.html-c5224cea.js" as="script"><link rel="prefetch" href="/home/assets/leveldb.html-7bcf9f56.js" as="script"><link rel="prefetch" href="/home/assets/mev.html-a21fda68.js" as="script"><link rel="prefetch" href="/home/assets/mpt.html-a1751887.js" as="script"><link rel="prefetch" href="/home/assets/node_client.html-f0070010.js" as="script"><link rel="prefetch" href="/home/assets/rlp.html-eac876dc.js" as="script"><link rel="prefetch" href="/home/assets/statedb.html-d6694a31.js" as="script"><link rel="prefetch" href="/home/assets/transaction.html-c44e25fc.js" as="script"><link rel="prefetch" href="/home/assets/index.html-9c3a9a4e.js" as="script"><link rel="prefetch" href="/home/assets/distributed.html-bf75e88f.js" as="script"><link rel="prefetch" href="/home/assets/gin.html-5a7ae016.js" as="script"><link rel="prefetch" href="/home/assets/gorm_1.html-9f700d6a.js" as="script"><link rel="prefetch" href="/home/assets/gorm_2.html-ab65fea0.js" as="script"><link rel="prefetch" href="/home/assets/goweb.html-36898153.js" as="script"><link rel="prefetch" href="/home/assets/protobuf.html-518e7c48.js" as="script"><link rel="prefetch" href="/home/assets/rpc.html-360c7a38.js" as="script"><link rel="prefetch" href="/home/assets/sse.html-8c347199.js" as="script"><link rel="prefetch" href="/home/assets/test.html-47d68a2c.js" as="script"><link rel="prefetch" href="/home/assets/websocket.html-1bb422c6.js" as="script"><link rel="prefetch" href="/home/assets/1.html-f888f9b6.js" as="script"><link rel="prefetch" href="/home/assets/2.html-87f7e677.js" as="script"><link rel="prefetch" href="/home/assets/3.html-9c73ffaf.js" as="script"><link rel="prefetch" href="/home/assets/4.html-9267d80d.js" as="script"><link rel="prefetch" href="/home/assets/index.html-0eb8ec35.js" as="script"><link rel="prefetch" href="/home/assets/index.html-c56c873f.js" as="script"><link rel="prefetch" href="/home/assets/dockerbase.html-bb8874d5.js" as="script"><link rel="prefetch" href="/home/assets/dockerutil.html-a0f6f384.js" as="script"><link rel="prefetch" href="/home/assets/k8sbase.html-e59493b5.js" as="script"><link rel="prefetch" href="/home/assets/index.html-83615f41.js" as="script"><link rel="prefetch" href="/home/assets/section0.html-039c3cc5.js" as="script"><link rel="prefetch" href="/home/assets/index.html-9285857b.js" as="script"><link rel="prefetch" href="/home/assets/mybatis.html-31fc11b4.js" as="script"><link rel="prefetch" href="/home/assets/index.html-e6c2a3c3.js" as="script"><link rel="prefetch" href="/home/assets/base.html-d58c7fc1.js" as="script"><link rel="prefetch" href="/home/assets/progress_section_1.html-800d9f09.js" as="script"><link rel="prefetch" href="/home/assets/progress_section_2.html-357a6e1b.js" as="script"><link rel="prefetch" href="/home/assets/progress_section_3.html-fad3c5e6.js" as="script"><link rel="prefetch" href="/home/assets/progress_section_4.html-fa392d43.js" as="script"><link rel="prefetch" href="/home/assets/progress_section_5.html-b9cb5069.js" as="script"><link rel="prefetch" href="/home/assets/index.html-662eb6dd.js" as="script"><link rel="prefetch" href="/home/assets/alert.html-450d9750.js" as="script"><link rel="prefetch" href="/home/assets/clustering.html-eddfd39f.js" as="script"><link rel="prefetch" href="/home/assets/exporter.html-f45ba38e.js" as="script"><link rel="prefetch" href="/home/assets/intro.html-cfe230d9.js" as="script"><link rel="prefetch" href="/home/assets/promql.html-8e4e8eff.js" as="script"><link rel="prefetch" href="/home/assets/servicediscovery.html-828a132e.js" as="script"><link rel="prefetch" href="/home/assets/index.html-8be98b8d.js" as="script"><link rel="prefetch" href="/home/assets/base_usage.html-b3431008.js" as="script"><link rel="prefetch" href="/home/assets/1.html-bc4206ed.js" as="script"><link rel="prefetch" href="/home/assets/2.html-2ce76e02.js" as="script"><link rel="prefetch" href="/home/assets/3.html-1b8acd15.js" as="script"><link rel="prefetch" href="/home/assets/4.html-5c1faace.js" as="script"><link rel="prefetch" href="/home/assets/index.html-3e5041d8.js" as="script"><link rel="prefetch" href="/home/assets/index.html-a1a854ee.js" as="script"><link rel="prefetch" href="/home/assets/base.html-c8038b3b.js" as="script"><link rel="prefetch" href="/home/assets/progress.html-9801829a.js" as="script"><link rel="prefetch" href="/home/assets/script.html-aeb5f2fd.js" as="script"><link rel="prefetch" href="/home/assets/index.html-5877b882.js" as="script"><link rel="prefetch" href="/home/assets/java_usage.html-cf18fd72.js" as="script"><link rel="prefetch" href="/home/assets/python_usage.html-19a2fad6.js" as="script"><link rel="prefetch" href="/home/assets/system_usage.html-6c67e112.js" as="script"><link rel="prefetch" href="/home/assets/index.html-59ebba52.js" as="script"><link rel="prefetch" href="/home/assets/docker_tutorial.html-63b28473.js" as="script"><link rel="prefetch" href="/home/assets/firewall_tutorial.html-7635d522.js" as="script"><link rel="prefetch" href="/home/assets/mysql_tutorial.html-1afbb6b5.js" as="script"><link rel="prefetch" href="/home/assets/nginx_tutorial.html-60e4d9c5.js" as="script"><link rel="prefetch" href="/home/assets/other_tutorial.html-cb3f8d82.js" as="script"><link rel="prefetch" href="/home/assets/1.html-630eb160.js" as="script"><link rel="prefetch" href="/home/assets/2.html-f8cf5a2d.js" as="script"><link rel="prefetch" href="/home/assets/index.html-53093d35.js" as="script"><link rel="prefetch" href="/home/assets/5.html-55dc889b.js" as="script"><link rel="prefetch" href="/home/assets/6.html-ef0fb957.js" as="script"><link rel="prefetch" href="/home/assets/7.html-7724bfb9.js" as="script"><link rel="prefetch" href="/home/assets/Mybatis.html-cf2f131d.js" as="script"><link rel="prefetch" href="/home/assets/index.html-7a4a5f7c.js" as="script"><link rel="prefetch" href="/home/assets/Spring.html-654d5e01.js" as="script"><link rel="prefetch" href="/home/assets/SpringBoot.html-6b1a1fbe.js" as="script"><link rel="prefetch" href="/home/assets/SpringMVC.html-8abc7cb4.js" as="script"><link rel="prefetch" href="/home/assets/1.html-3ff22435.js" as="script"><link rel="prefetch" href="/home/assets/2.html-77e0a534.js" as="script"><link rel="prefetch" href="/home/assets/3.html-09ae2c02.js" as="script"><link rel="prefetch" href="/home/assets/4.html-91a74615.js" as="script"><link rel="prefetch" href="/home/assets/5.html-e7a2a051.js" as="script"><link rel="prefetch" href="/home/assets/index.html-ccbc58af.js" as="script"><link rel="prefetch" href="/home/assets/index.html-bbc92682.js" as="script"><link rel="prefetch" href="/home/assets/less.html-4ce2a87d.js" as="script"><link rel="prefetch" href="/home/assets/sass.html-5d9bcb6a.js" as="script"><link rel="prefetch" href="/home/assets/1.html-77b76256.js" as="script"><link rel="prefetch" href="/home/assets/2.html-8dafd982.js" as="script"><link rel="prefetch" href="/home/assets/index.html-bf411dd5.js" as="script"><link rel="prefetch" href="/home/assets/1.html-bf5112f5.js" as="script"><link rel="prefetch" href="/home/assets/2.html-e8b75325.js" as="script"><link rel="prefetch" href="/home/assets/index.html-fc6a6b3b.js" as="script"><link rel="prefetch" href="/home/assets/1.html-bdb0a95e.js" as="script"><link rel="prefetch" href="/home/assets/2.html-274b338e.js" as="script"><link rel="prefetch" href="/home/assets/3.html-6ee1fc71.js" as="script"><link rel="prefetch" href="/home/assets/4.html-0b440e95.js" as="script"><link rel="prefetch" href="/home/assets/5.html-f5434dcc.js" as="script"><link rel="prefetch" href="/home/assets/6.html-20d19bec.js" as="script"><link rel="prefetch" href="/home/assets/7.html-dbf64525.js" as="script"><link rel="prefetch" href="/home/assets/8.html-fa33bc0b.js" as="script"><link rel="prefetch" href="/home/assets/9.html-b42c4eb0.js" as="script"><link rel="prefetch" href="/home/assets/index.html-7dae46e3.js" as="script"><link rel="prefetch" href="/home/assets/new.html-86b20ee8.js" as="script"><link rel="prefetch" href="/home/assets/1.html-8021ccbd.js" as="script"><link rel="prefetch" href="/home/assets/index.html-8c8a13df.js" as="script"><link rel="prefetch" href="/home/assets/index.html-41d7ee2e.js" as="script"><link rel="prefetch" href="/home/assets/uniCloud.html-546bbf0e.js" as="script"><link rel="prefetch" href="/home/assets/uniTips.html-3206d2bf.js" as="script"><link rel="prefetch" href="/home/assets/1.html-0455986a.js" as="script"><link rel="prefetch" href="/home/assets/index.html-4589423c.js" as="script"><link rel="prefetch" href="/home/assets/index.html-76746c43.js" as="script"><link rel="prefetch" href="/home/assets/api_tutorial.html-ed9c31b8.js" as="script"><link rel="prefetch" href="/home/assets/base_tutorial.html-556ad087.js" as="script"><link rel="prefetch" href="/home/assets/pinia.html-58bcb997.js" as="script"><link rel="prefetch" href="/home/assets/vue2.html-4944f3ee.js" as="script"><link rel="prefetch" href="/home/assets/vue3_1.html-9d4fc627.js" as="script"><link rel="prefetch" href="/home/assets/vue3_2.html-981f6efb.js" as="script"><link rel="prefetch" href="/home/assets/1.html-ab3da929.js" as="script"><link rel="prefetch" href="/home/assets/index.html-929eb883.js" as="script"><link rel="prefetch" href="/home/assets/1.html-af1a2a63.js" as="script"><link rel="prefetch" href="/home/assets/index.html-2e8e38f8.js" as="script"><link rel="prefetch" href="/home/assets/1.html-12361a10.js" as="script"><link rel="prefetch" href="/home/assets/2.html-f40a224f.js" as="script"><link rel="prefetch" href="/home/assets/index.html-c899229f.js" as="script"><link rel="prefetch" href="/home/assets/index.html-995b4e84.js" as="script"><link rel="prefetch" href="/home/assets/jwt.html-bae20d54.js" as="script"><link rel="prefetch" href="/home/assets/shiro.html-aa9b7bf2.js" as="script"><link rel="prefetch" href="/home/assets/index.html-96b8b02a.js" as="script"><link rel="prefetch" href="/home/assets/nacos.html-6bb4081b.js" as="script"><link rel="prefetch" href="/home/assets/index.html-9dbdc317.js" as="script"><link rel="prefetch" href="/home/assets/spring_annotation.html-73df7efe.js" as="script"><link rel="prefetch" href="/home/assets/springboot.html-f24c29b5.js" as="script"><link rel="prefetch" href="/home/assets/404.html-284769a0.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/home/" class=""><!----><span class="site-name">不愿飞的蜂鸟首页</span></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><nav class="navbar-items can-hide"><!--[--><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Five研究生"><span class="title">Five研究生</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Five研究生"><span class="title">Five研究生</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>Block Chain Internship</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/home/master/ethereum/" class="" aria-label="ethereum"><!--[--><!--]--> ethereum <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/home/master/blockchaindevelopment/" class="" aria-label="block chain development"><!--[--><!--]--> block chain development <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/home/master/docker/" class="" aria-label="docker"><!--[--><!--]--> docker <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/home/master/golang/" class="" aria-label="golang"><!--[--><!--]--> golang <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/home/master/prometheus/" class="" aria-label="prometheus"><!--[--><!--]--> prometheus <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/home/master/shell/" class="" aria-label="shell"><!--[--><!--]--> shell <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>Java Engineering</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/home/master/redis/" class="" aria-label="Redis"><!--[--><!--]--> Redis <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/home/master/mysql/" class="" aria-label="MySQL"><!--[--><!--]--> MySQL <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/home/master/jvm/" class="" aria-label="JVM"><!--[--><!--]--> JVM <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/home/master/mybatis/" class="" aria-label="MyBatis"><!--[--><!--]--> MyBatis <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>Deep Learning</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/home/master/ubuntu/" class="" aria-label="Ubuntu"><!--[--><!--]--> Ubuntu <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/home/master/GNN/" class="" aria-label="GNN"><!--[--><!--]--> GNN <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/home/master/python/" class="" aria-label="Python"><!--[--><!--]--> Python <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Five本科"><span class="title">Five本科</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Five本科"><span class="title">Five本科</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>foreground</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/home/tech/js/" class="" aria-label="JavaScript"><!--[--><!--]--> JavaScript <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/home/tech/typescript/" class="" aria-label="TypeScript"><!--[--><!--]--> TypeScript <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/home/tech/html_css/" class="" aria-label="HTML_CSS"><!--[--><!--]--> HTML_CSS <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/home/tech/less_sass/" class="" aria-label="Less_Sass"><!--[--><!--]--> Less_Sass <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/home/tech/react/" class="" aria-label="React"><!--[--><!--]--> React <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/home/tech/vue/" class="" aria-label="Vue"><!--[--><!--]--> Vue <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/home/tech/vite/" class="" aria-label="Vite"><!--[--><!--]--> Vite <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/home/tech/webpack/" class="" aria-label="Webpack"><!--[--><!--]--> Webpack <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>background</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/home/tech/java/" class="" aria-label="JAVA"><!--[--><!--]--> JAVA <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/home/tech/node/" class="" aria-label="Node"><!--[--><!--]--> Node <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>app.mp</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/home/tech/miniProgram/" class="" aria-label="MiniProgram"><!--[--><!--]--> MiniProgram <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/home/tech/uni-app/" class="" aria-label="uni-app"><!--[--><!--]--> uni-app <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>server</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/home/tech/centos/" class="" aria-label="Centos"><!--[--><!--]--> Centos <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Five本科课程"><span class="title">Five本科课程</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Five本科课程"><span class="title">Five本科课程</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/home/course/operating_system/" class="" aria-label="操作系统"><!--[--><!--]--> 操作系统 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/home/course/computer_network/" class="" aria-label="计算机网络技术"><!--[--><!--]--> 计算机网络技术 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/home/course/datastructure_and_algorithm/" class="" aria-label="数据结构和算法"><!--[--><!--]--> 数据结构和算法 <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Five杂学"><span class="title">Five杂学</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Five杂学"><span class="title">Five杂学</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>Java Section</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/home/trivia/spring/" class="router-link-active" aria-label="Spring"><!--[--><!--]--> Spring <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/home/trivia/juc/" class="" aria-label="JUC"><!--[--><!--]--> JUC <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/home/trivia/netty/" class="" aria-label="Netty"><!--[--><!--]--> Netty <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/home/trivia/security/" class="" aria-label="Security"><!--[--><!--]--> Security <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/home/trivia/service/" class="" aria-label="Service"><!--[--><!--]--> Service <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul></div></div><div class="navbar-item"><a class="external-link" href="https://github.com/liushun-ing" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button class="toggle-color-mode-button" title="toggle color mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><form class="search-box" role="search"><input type="search" placeholder="Search" autocomplete="off" spellcheck="false" value><!----></form></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-items"><!--[--><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Five研究生"><span class="title">Five研究生</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Five研究生"><span class="title">Five研究生</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>Block Chain Internship</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/home/master/ethereum/" class="" aria-label="ethereum"><!--[--><!--]--> ethereum <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/home/master/blockchaindevelopment/" class="" aria-label="block chain development"><!--[--><!--]--> block chain development <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/home/master/docker/" class="" aria-label="docker"><!--[--><!--]--> docker <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/home/master/golang/" class="" aria-label="golang"><!--[--><!--]--> golang <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/home/master/prometheus/" class="" aria-label="prometheus"><!--[--><!--]--> prometheus <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/home/master/shell/" class="" aria-label="shell"><!--[--><!--]--> shell <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>Java Engineering</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/home/master/redis/" class="" aria-label="Redis"><!--[--><!--]--> Redis <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/home/master/mysql/" class="" aria-label="MySQL"><!--[--><!--]--> MySQL <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/home/master/jvm/" class="" aria-label="JVM"><!--[--><!--]--> JVM <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/home/master/mybatis/" class="" aria-label="MyBatis"><!--[--><!--]--> MyBatis <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>Deep Learning</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/home/master/ubuntu/" class="" aria-label="Ubuntu"><!--[--><!--]--> Ubuntu <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/home/master/GNN/" class="" aria-label="GNN"><!--[--><!--]--> GNN <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/home/master/python/" class="" aria-label="Python"><!--[--><!--]--> Python <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Five本科"><span class="title">Five本科</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Five本科"><span class="title">Five本科</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>foreground</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/home/tech/js/" class="" aria-label="JavaScript"><!--[--><!--]--> JavaScript <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/home/tech/typescript/" class="" aria-label="TypeScript"><!--[--><!--]--> TypeScript <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/home/tech/html_css/" class="" aria-label="HTML_CSS"><!--[--><!--]--> HTML_CSS <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/home/tech/less_sass/" class="" aria-label="Less_Sass"><!--[--><!--]--> Less_Sass <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/home/tech/react/" class="" aria-label="React"><!--[--><!--]--> React <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/home/tech/vue/" class="" aria-label="Vue"><!--[--><!--]--> Vue <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/home/tech/vite/" class="" aria-label="Vite"><!--[--><!--]--> Vite <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/home/tech/webpack/" class="" aria-label="Webpack"><!--[--><!--]--> Webpack <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>background</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/home/tech/java/" class="" aria-label="JAVA"><!--[--><!--]--> JAVA <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/home/tech/node/" class="" aria-label="Node"><!--[--><!--]--> Node <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>app.mp</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/home/tech/miniProgram/" class="" aria-label="MiniProgram"><!--[--><!--]--> MiniProgram <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/home/tech/uni-app/" class="" aria-label="uni-app"><!--[--><!--]--> uni-app <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>server</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/home/tech/centos/" class="" aria-label="Centos"><!--[--><!--]--> Centos <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Five本科课程"><span class="title">Five本科课程</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Five本科课程"><span class="title">Five本科课程</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/home/course/operating_system/" class="" aria-label="操作系统"><!--[--><!--]--> 操作系统 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/home/course/computer_network/" class="" aria-label="计算机网络技术"><!--[--><!--]--> 计算机网络技术 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/home/course/datastructure_and_algorithm/" class="" aria-label="数据结构和算法"><!--[--><!--]--> 数据结构和算法 <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Five杂学"><span class="title">Five杂学</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Five杂学"><span class="title">Five杂学</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>Java Section</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/home/trivia/spring/" class="router-link-active" aria-label="Spring"><!--[--><!--]--> Spring <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/home/trivia/juc/" class="" aria-label="JUC"><!--[--><!--]--> JUC <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/home/trivia/netty/" class="" aria-label="Netty"><!--[--><!--]--> Netty <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/home/trivia/security/" class="" aria-label="Security"><!--[--><!--]--> Security <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/home/trivia/service/" class="" aria-label="Service"><!--[--><!--]--> Service <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul></div></div><div class="navbar-item"><a class="external-link" href="https://github.com/liushun-ing" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-items"><!--[--><li><p tabindex="0" class="sidebar-item sidebar-heading active">Spring <!----></p><ul style="" class="sidebar-item-children"><!--[--><li><a href="/home/trivia/spring/" class="router-link-active sidebar-item" aria-label="Navigation"><!--[--><!--]--> Navigation <!--[--><!--]--></a><!----></li><li><a href="/home/trivia/spring/springboot.html" class="sidebar-item" aria-label="SpringBoot"><!--[--><!--]--> SpringBoot <!--[--><!--]--></a><!----></li><li><a href="/home/trivia/spring/spring_annotation.html" class="sidebar-item" aria-label="Spring Annotation"><!--[--><!--]--> Spring Annotation <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/home/trivia/spring/springboot_base.html" class="router-link-active router-link-exact-active router-link-active sidebar-item active" aria-label="SpringBoot基础"><!--[--><!--]--> SpringBoot基础 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/home/trivia/spring/springboot_base.html#概念" class="router-link-active router-link-exact-active sidebar-item" aria-label="概念"><!--[--><!--]--> 概念 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/home/trivia/spring/springboot_base.html#特性" class="router-link-active router-link-exact-active sidebar-item" aria-label="特性"><!--[--><!--]--> 特性 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/home/trivia/spring/springboot_base.html#依赖管理机制" class="router-link-active router-link-exact-active sidebar-item" aria-label="依赖管理机制"><!--[--><!--]--> 依赖管理机制 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/home/trivia/spring/springboot_base.html#自动配置机制" class="router-link-active router-link-exact-active sidebar-item" aria-label="自动配置机制"><!--[--><!--]--> 自动配置机制 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/home/trivia/spring/springboot_base.html#条件注解" class="router-link-active router-link-exact-active sidebar-item" aria-label="条件注解"><!--[--><!--]--> 条件注解 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/home/trivia/spring/springboot_base.html#属性绑定" class="router-link-active router-link-exact-active sidebar-item" aria-label="属性绑定"><!--[--><!--]--> 属性绑定 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/home/trivia/spring/springboot_base.html#日志" class="router-link-active router-link-exact-active sidebar-item" aria-label="日志"><!--[--><!--]--> 日志 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/home/trivia/spring/springboot_base.html#" class="router-link-active router-link-exact-active sidebar-item" aria-label><!--[--><!--]-->  <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/home/trivia/spring/springboot_base.html#springboot-web开发" class="router-link-active router-link-exact-active sidebar-item" aria-label="springboot-web开发"><!--[--><!--]--> springboot-web开发 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/home/trivia/spring/springboot_base.html#webmvcautoconfiguration原理" class="router-link-active router-link-exact-active sidebar-item" aria-label="WebMvcAutoConfiguration原理"><!--[--><!--]--> WebMvcAutoConfiguration原理 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/home/trivia/spring/springboot_base.html#web默认配置" class="router-link-active router-link-exact-active sidebar-item" aria-label="Web默认配置"><!--[--><!--]--> Web默认配置 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/home/trivia/spring/springboot_base.html#静态资源映射" class="router-link-active router-link-exact-active sidebar-item" aria-label="静态资源映射"><!--[--><!--]--> 静态资源映射 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/home/trivia/spring/springboot_base.html#路径匹配规则" class="router-link-active router-link-exact-active sidebar-item" aria-label="路径匹配规则"><!--[--><!--]--> 路径匹配规则 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/home/trivia/spring/springboot_base.html#内容协商" class="router-link-active router-link-exact-active sidebar-item" aria-label="内容协商"><!--[--><!--]--> 内容协商 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/home/trivia/spring/springboot_base.html#错误处理" class="router-link-active router-link-exact-active sidebar-item" aria-label="错误处理"><!--[--><!--]--> 错误处理 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/home/trivia/spring/springboot_base.html#profiles环境" class="router-link-active router-link-exact-active sidebar-item" aria-label="Profiles环境"><!--[--><!--]--> Profiles环境 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/home/trivia/spring/springboot_base.html#注解使用" class="router-link-active router-link-exact-active sidebar-item" aria-label="注解使用"><!--[--><!--]--> 注解使用 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/home/trivia/spring/springboot_base.html#环境激活" class="router-link-active router-link-exact-active sidebar-item" aria-label="环境激活"><!--[--><!--]--> 环境激活 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/home/trivia/spring/springboot_base.html#profile配置文件" class="router-link-active router-link-exact-active sidebar-item" aria-label="Profile配置文件"><!--[--><!--]--> Profile配置文件 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/home/trivia/spring/springboot_base.html#核心原理" class="router-link-active router-link-exact-active sidebar-item" aria-label="核心原理"><!--[--><!--]--> 核心原理 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/home/trivia/spring/springboot_base.html#springboot生命周期" class="router-link-active router-link-exact-active sidebar-item" aria-label="Springboot生命周期"><!--[--><!--]--> Springboot生命周期 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/home/trivia/spring/springboot_base.html#springboot事件" class="router-link-active router-link-exact-active sidebar-item" aria-label="springboot事件"><!--[--><!--]--> springboot事件 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/home/trivia/spring/springboot_base.html#自定义事件驱动开发" class="router-link-active router-link-exact-active sidebar-item" aria-label="自定义事件驱动开发"><!--[--><!--]--> 自定义事件驱动开发 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/home/trivia/spring/springboot_base.html#springbootapplication" class="router-link-active router-link-exact-active sidebar-item" aria-label="SpringBootApplication"><!--[--><!--]--> SpringBootApplication <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/home/trivia/spring/springboot_base.html#自定义starter" class="router-link-active router-link-exact-active sidebar-item" aria-label="自定义starter"><!--[--><!--]--> 自定义starter <!--[--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul></li><!--]--></ul></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><!--]--><div><h1 id="springboot基础" tabindex="-1"><a class="header-anchor" href="#springboot基础" aria-hidden="true">#</a> SpringBoot基础</h1><h2 id="概念" tabindex="-1"><a class="header-anchor" href="#概念" aria-hidden="true">#</a> 概念</h2><p>SpringBoot 帮我们简单、快速地创建一个独立的、生产级别的 <strong>Spring 应用（说明：SpringBoot底层是Spring）</strong></p><p>大多数 SpringBoot 应用只需要编写少量配置即可快速整合 Spring 平台以及第三方技术</p><h3 id="特性" tabindex="-1"><a class="header-anchor" href="#特性" aria-hidden="true">#</a> 特性</h3><ul><li><p>快速创建独立 Spring 应用</p><ul><li>SSM：导包、写配置、启动运行</li></ul></li><li><p>直接嵌入Tomcat、Jetty or Undertow（无需部署 war 包）【Servlet容器】</p><ul><li><p>linux java tomcat mysql： war 放到 tomcat 的 webapps下</p></li><li><p>jar： java环境: java -jar</p></li></ul></li><li><p><strong>重点</strong>：提供可选的starter，简化应用<strong>整合</strong></p><ul><li><p><strong>场景启动器</strong>（starter）：web、json、邮件、oss（对象存储）、异步、定时任务、缓存...</p></li><li><p>导包一堆，控制好版本。</p></li><li><p>为每一种场景准备了一个依赖； <strong>web-starter, mybatis-starter</strong></p></li></ul></li><li><p>**重点：**按需自动配置 Spring 以及 第三方库</p><ul><li><p>如果这些场景我要使用（生效）。这个场景的所有配置都会自动配置好。</p></li><li><p><strong>约定大于配置</strong>：每个场景都有很多默认配置。</p></li><li><p>自定义：配置文件中修改几项就可以</p></li></ul></li><li><p>提供生产级特性：如 监控指标、健康检查、外部化配置等</p><ul><li>监控指标、健康检查（k8s）、外部化配置</li></ul></li><li><p>无代码生成、无xml</p></li></ul><h3 id="依赖管理机制" tabindex="-1"><a class="header-anchor" href="#依赖管理机制" aria-hidden="true">#</a> 依赖管理机制</h3><p>思考：</p><p>1、为什么导入<code>starter-web</code>所有相关依赖都导入进来？</p><ul><li>开发什么场景，导入什么场景启动器。</li><li>maven依赖传递原则。A-B-C： A就拥有B和C</li><li>导入场景启动器。场景启动器：自动把这个场景的所有核心依赖全部导入进来</li></ul><p>2、为什么版本号都不用写？</p><ul><li>每个boot项目都有一个父项目<code>spring-boot-starter-parent</code></li><li>parent的父项目是<code>spring-boot-dependencies</code></li><li>父项目 版本仲裁中心，把所有常见的jar的依赖版本都声明好了。</li><li>比如：<code>mysql-connector-j</code></li></ul><p>3、自定义版本号</p><ul><li>利用maven的就近原则 <ul><li>直接在当前项目properties标签中声明父项目用的版本属性的key</li><li>直接在导入依赖的时候声明版本</li></ul></li></ul><p>4、第三方的jar包</p><ul><li>boot父项目没有管理的需要自行声明好</li></ul><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token comment">&lt;!-- https://mvnrepository.com/artifact/com.alibaba/druid --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.alibaba<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>druid<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.2.16<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><img src="/home/assets/1679294529375-4ee1cd26-8ebc-4abf-bff9-f8775e10c927-6902f384.png" alt="image.png" style="zoom:67%;"><h3 id="自动配置机制" tabindex="-1"><a class="header-anchor" href="#自动配置机制" aria-hidden="true">#</a> 自动配置机制</h3><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>

  <span class="token comment">//java10： 局部变量类型的自动推断</span>
  <span class="token keyword">var</span> ioc <span class="token operator">=</span> <span class="token class-name">SpringApplication</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">MainApplication</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">//1、获取容器中所有组件的名字</span>
  <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> names <span class="token operator">=</span> ioc<span class="token punctuation">.</span><span class="token function">getBeanDefinitionNames</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">//2、挨个遍历：</span>
  <span class="token comment">// dispatcherServlet、beanNameViewResolver、characterEncodingFilter、multipartResolver</span>
  <span class="token comment">// SpringBoot把以前配置的核心组件现在都给我们自动配置好了。</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">String</span> name <span class="token operator">:</span> names<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><p><strong>默认的包扫描规则</strong></p><ul><li><p><code>@SpringBootApplication</code> 标注的类就是主程序类</p></li><li><p><strong>SpringBoot只会扫描主程序所在的包及其下面的子包，自动的component-scan功能</strong></p></li><li><p><strong>自定义扫描路径</strong></p><ul><li><p>@SpringBootApplication(scanBasePackages = &quot;com.xx&quot;)</p></li><li><p><code>@ComponentScan(&quot;com.xxx&quot;)</code> 直接指定扫描的路径</p></li></ul></li></ul></li><li><p><strong>配置默认值</strong></p><ul><li><p><strong>配置文件</strong>的所有配置项是和某个<strong>类的对象</strong>值进行一一绑定的。</p></li><li><p>绑定了配置文件中每一项值的类： <strong>属性类</strong>。</p></li><li><p>比如：</p><ul><li><p><code>ServerProperties</code>绑定了所有Tomcat服务器有关的配置</p></li><li><p><code>MultipartProperties</code>绑定了所有文件上传相关的配置</p></li><li><p>....参照<a href="https://docs.spring.io/spring-boot/docs/current/reference/html/application-properties.html#appendix.application-properties.server" target="_blank" rel="noopener noreferrer">官方文档<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>：或者参照 绑定的 <strong>属性类</strong>。</p></li></ul></li></ul></li><li><p>按需加载自动配置</p><ul><li><p>导入场景<code>spring-boot-starter-web</code></p></li><li><p>场景启动器除了会导入相关功能依赖，还会导入一个<code>spring-boot-starter</code>，是所有<code>starter</code>的<code>starter</code>，基础核心starter</p></li><li><p><code>spring-boot-starter</code>导入了一个包 <code>spring-boot-autoconfigure</code>。包里面都是各种场景的<code>AutoConfiguration</code><strong>自动配置类</strong></p></li><li><p>虽然全场景的自动配置都在 <code>spring-boot-autoconfigure</code>这个包，但是不是全都开启的。</p><ul><li>导入哪个场景就开启哪个自动配置</li></ul></li></ul></li></ul><p>总结： 导入场景启动器、触发 <code>spring-boot-autoconfigure</code>这个包的自动配置生效、容器中就会具有相关场景的功能</p><blockquote><p><strong>完整流程</strong></p></blockquote><p>思考：</p><p>1、SpringBoot怎么实现导一个<code>**starter**</code><strong>、写一些简单配置，应用就能跑起来，我们无需关心整合</strong></p><p>2、为什么Tomcat的端口号可以配置在<code>application.properties</code>中，并且<code>Tomcat</code>能启动成功？</p><p>3、导入场景后哪些自动配置能生效？</p><img src="/home/assets/1679970508234-3c6b8ecc-6372-4eb5-8c67-563054d1a72d-359130e6.png" alt="img" style="zoom:67%;"><p><em><strong>自动配置流程细节梳理：</strong></em></p><p>**1、**导入<code>starter-web</code>：导入了web开发场景</p><ul><li>1、场景启动器导入了相关场景的所有依赖：<code>starter-json</code>、<code>starter-tomcat</code>、<code>springmvc</code></li><li>2、每个场景启动器都引入了一个<code>spring-boot-starter</code>，核心场景启动器。</li><li>3、<strong>核心场景启动器</strong>引入了<code>spring-boot-autoconfigure</code>包。</li><li>4、<code>spring-boot-autoconfigure</code>里面囊括了所有场景的所有配置。</li><li>5、只要这个包下的所有类都能生效，那么相当于SpringBoot官方写好的整合功能就生效了。</li><li>6、SpringBoot默认却扫描不到 <code>spring-boot-autoconfigure</code>下写好的所有<strong>配置类</strong>。（这些<strong>配置类</strong>给我们做了整合操作），<strong>默认只扫描主程序所在的包</strong>。</li></ul><p><strong>2、</strong> <strong>主程序</strong>：<code>@SpringBootApplication</code></p><ul><li><p>1、<code>@SpringBootApplication</code>由三个注解组成<code>@SpringBootConfiguration</code>、<code>@EnableAutoConfiguratio</code>、<code>@ComponentScan</code></p></li><li><p>2、SpringBoot默认只能扫描自己主程序所在的包及其下面的子包，扫描不到 <code>spring-boot-autoconfigure</code>包中官方写好的<strong>配置类</strong></p></li><li><p>3、<strong><code>@EnableAutoConfiguration</code></strong>：SpringBoot <strong>开启自动配置的核心</strong>。</p><ul><li><p>是由<code>@Import(AutoConfigurationImportSelector.class)</code>提供功能：批量给容器中导入组件。</p></li><li><p>SpringBoot启动会默认加载 142个配置类。</p></li><li><p>这<strong>142个配置类</strong>来自于<code>spring-boot-autoconfigure</code>下 <code>META-INF/spring/**org.springframework.boot.autoconfigure.AutoConfiguration**.imports</code>文件指定的</p></li><li><p>项目启动的时候利用 @Import 批量导入组件机制把 <code>autoconfigure</code> 包下的142 <code>xxxxAutoConfiguration</code>类导入进来（<strong>自动配置类</strong>）</p></li><li><p>虽然导入了<code>142</code>个自动配置类，并不是这<code>142</code>个自动配置类都能生效</p></li></ul></li><li><p>4、按需生效：</p><ul><li>每一个自动配置类，都有条件注解<code>@ConditionalOnxxx</code>，只有条件成立，才能生效</li></ul></li></ul><p><strong>3、</strong><code>xxxxAutoConfiguration</code><strong>自动配置类</strong></p><ul><li><strong>1、给容器中使用@Bean 放一堆组件。</strong></li><li>2、每个<strong>自动配置类</strong>都可能有这个注解<code>@EnableConfigurationProperties(ServerProperties.class)</code>，用来把配置文件中配的指定前缀的属性值封装到 <code>xxxProperties</code><strong>属性类</strong>中</li><li>3、以Tomcat为例：把服务器的所有配置都是以<code>server</code>开头的。配置都封装到了属性类中。</li><li>4、给<strong>容器</strong>中放的所有<strong>组件</strong>的一些<strong>核心参数</strong>，都来自于<code>**xxxProperties**</code><strong>。</strong><code>**xxxProperties**</code><strong>都是和配置文件绑定。</strong></li><li><strong>只需要改配置文件的值，核心组件的底层参数都能修改</strong></li></ul><p>**4、**写业务，全程无需关心各种整合（底层这些整合写好了，而且也生效了）</p><p><strong>核心流程总结：</strong></p><p>1、导入<code>starter</code>，就会导入<code>autoconfigure</code>包。</p><p>2、<code>autoconfigure</code> 包里面 有一个文件 <code>META-INF/spring/org.springframework.boot.autoconfigure.AutoConfiguration.imports</code>,里面指定的所有启动要加载的自动配置类</p><p>3、@EnableAutoConfiguration 会自动的把上面文件里面写的所有<strong>自动配置类都导入进来。xxxAutoConfiguration 是有条件注解进行按需加载</strong></p><p>4、<code>xxxAutoConfiguration</code>给容器中导入一堆组件，组件都是从 <code>xxxProperties</code>中提取属性值</p><p>5、<code>xxxProperties</code>又是和<strong>配置文件</strong>进行了绑定</p><p>**效果：**导入<code>starter</code>、修改配置文件，就能修改底层行为。</p><h3 id="条件注解" tabindex="-1"><a class="header-anchor" href="#条件注解" aria-hidden="true">#</a> 条件注解</h3><p>如果注解指定的<strong>条件成立</strong>，则触发指定行为</p><p><em><strong>@ConditionalOnXxx</strong></em></p><p><strong>@ConditionalOnClass：如果类路径中存在这个类，则触发指定行为</strong></p><p><strong>@ConditionalOnMissingClass：如果类路径中不存在这个类，则触发指定行为</strong></p><p><strong>@ConditionalOnBean：如果容器中存在这个Bean（组件），则触发指定行为</strong></p><p><strong>@ConditionalOnMissingBean：如果容器中不存在这个Bean（组件），则触发指定行为</strong></p><p><strong>@ConditionalOnBean（value=组件类型，name=组件名字）：判断容器中是否有这个类型的组件，并且名字是指定的值</strong></p><p>@ConditionalOnRepositoryType (org.springframework.boot.autoconfigure.data) @ConditionalOnDefaultWebSecurity (org.springframework.boot.autoconfigure.security) @ConditionalOnSingleCandidate (org.springframework.boot.autoconfigure.condition) @ConditionalOnWebApplication (org.springframework.boot.autoconfigure.condition) @ConditionalOnWarDeployment (org.springframework.boot.autoconfigure.condition) @ConditionalOnJndi (org.springframework.boot.autoconfigure.condition) @ConditionalOnResource (org.springframework.boot.autoconfigure.condition) @ConditionalOnExpression (org.springframework.boot.autoconfigure.condition) <strong>@ConditionalOnClass</strong> (org.springframework.boot.autoconfigure.condition) @ConditionalOnEnabledResourceChain (org.springframework.boot.autoconfigure.web) <strong>@ConditionalOnMissingClass</strong> (org.springframework.boot.autoconfigure.condition) @ConditionalOnNotWebApplication (org.springframework.boot.autoconfigure.condition) @ConditionalOnProperty (org.springframework.boot.autoconfigure.condition) @ConditionalOnCloudPlatform (org.springframework.boot.autoconfigure.condition) <strong>@ConditionalOnBean</strong> (org.springframework.boot.autoconfigure.condition) <strong>@ConditionalOnMissingBean</strong> (org.springframework.boot.autoconfigure.condition) @ConditionalOnMissingFilterBean (org.springframework.boot.autoconfigure.web.servlet) @Profile (org.springframework.context.annotation) @ConditionalOnInitializedRestarter (org.springframework.boot.devtools.restart) @ConditionalOnGraphQlSchema (org.springframework.boot.autoconfigure.graphql) @ConditionalOnJava (org.springframework.boot.autoconfigure.condition)</p><h3 id="属性绑定" tabindex="-1"><a class="header-anchor" href="#属性绑定" aria-hidden="true">#</a> 属性绑定</h3><p><strong>@ConfigurationProperties： 声明组件的属性和配置文件哪些前缀开始项进行绑定（使用这个的前提是该类已经被注册为bean）</strong></p><p><strong>@EnableConfigurationProperties：快速注册注解：</strong></p><ul><li>**场景：**SpringBoot默认只扫描自己主程序所在的包。如果导入第三方包，即使组件上标注了 @Component、@ConfigurationProperties 注解，也没用。因为组件都扫描不进来，此时使用这个注解就可以快速进行属性绑定并把组件注册进容器</li></ul><p>将容器中任意<strong>组件（Bean）的属性值</strong>和<strong>配置文件</strong>的配置项的值<strong>进行绑定</strong></p><ol><li>给容器中注册组件（@Component、@Bean）</li><li>使用@ConfigurationProperties 声明组件和配置文件的哪些配置项进行绑定</li></ol><p>或者</p><ol><li>使用@ConfigurationProperties 声明组件和配置文件的哪些配置项进行绑定</li><li>然后使用@EnableConfigurationProperties将上一步声明的类注册为组件，并完成属性绑定</li></ol><h2 id="日志" tabindex="-1"><a class="header-anchor" href="#日志" aria-hidden="true">#</a> 日志</h2><img src="/home/assets/screenshot2024-04-0520.22.22-9e3b089f.png" alt="screenshot2024-04-05 20.22.22" style="zoom:50%;"><p><strong>SpringBoot怎么把日志默认配置好的</strong></p><p>1、每个<code>starter</code>场景，都会导入一个核心场景<code>spring-boot-starter</code></p><p>2、核心场景引入了日志的所用功能<code>spring-boot-starter-logging</code></p><p>3、默认使用了<code>logback + slf4j</code> 组合作为默认底层日志</p><p>4、<code>日志是系统一启动就要用</code>，<code>xxxAutoConfiguration</code>是系统启动好了以后放好的组件，后来用的。</p><p>5、日志是利用<strong>监听器机制</strong>配置好的。<code>ApplicationListener</code>。</p><p>6、日志所有的配置都可以通过修改配置文件实现。以<code>logging</code>开始的所有配置。</p><blockquote><p>日志格式</p></blockquote><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token number">2023</span>-03-31T13:56:17.511+08:00  INFO <span class="token number">4944</span> --- <span class="token punctuation">[</span>           main<span class="token punctuation">]</span> o.apache.catalina.core.StandardService   <span class="token builtin class-name">:</span> Starting <span class="token function">service</span> <span class="token punctuation">[</span>Tomcat<span class="token punctuation">]</span>
<span class="token number">2023</span>-03-31T13:56:17.511+08:00  INFO <span class="token number">4944</span> --- <span class="token punctuation">[</span>           main<span class="token punctuation">]</span> o.apache.catalina.core.StandardEngine    <span class="token builtin class-name">:</span> Starting Servlet engine: <span class="token punctuation">[</span>Apache Tomcat/10.1.7<span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>默认输出格式：</p><ul><li>时间和日期：毫秒级精度</li><li>日志级别：ERROR, WARN, INFO, DEBUG, or TRACE.</li><li>进程 ID</li><li>---： 消息分割符</li><li>线程名： 使用[]包含</li><li>Logger 名： 通常是产生日志的<strong>类名</strong></li><li>消息： 日志记录的内容</li></ul><p>注意： logback 没有FATAL级别，对应的是ERROR</p><blockquote><p>使用日志</p></blockquote><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token class-name">Logger</span> logger <span class="token operator">=</span> <span class="token class-name">LoggerFactory</span><span class="token punctuation">.</span><span class="token function">getLogger</span><span class="token punctuation">(</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

或者使用<span class="token class-name">Lombok</span>的<span class="token annotation punctuation">@Slf4j</span>注解<span class="token punctuation">,</span>会自动为当前类注入一个log属性
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>日志级别</p></blockquote><ul><li><p>由低到高：<code>ALL,TRACE, DEBUG, INFO, WARN, ERROR,FATAL,OFF</code>；<strong>只会打印指定级别及以上级别的日志</strong></p><ul><li><p>ALL：打印所有日志</p></li><li><p>TRACE：追踪框架详细流程日志，一般不使用</p></li><li><p>DEBUG：开发调试细节日志</p></li><li><p>INFO：关键、感兴趣信息日志</p></li><li><p>WARN：警告但不是错误的信息日志，比如：版本过时</p></li><li><p>ERROR：业务错误日志，比如出现各种异常</p></li><li><p>FATAL：致命错误日志，比如jvm系统崩溃</p></li><li><p>OFF：关闭所有日志记录</p></li></ul></li><li><p>不指定级别的所有类，都使用root指定的级别作为默认级别</p></li><li><p>SpringBoot日志<strong>默认级别是</strong> <strong>INFO</strong></p></li></ul><ol><li>在<code>application.properties/yaml</code>中配置<code>logging.level.&lt;logger-name&gt;=&lt;level&gt;</code>指定日志级别</li><li>level可取值范围：<code>TRACE, DEBUG, INFO, WARN, ERROR, FATAL, or OFF</code>，定义在 <code>LogLevel</code>类中</li><li>root 的<code>logger-name</code>叫root，可以配置<code>logging.level.root=warn</code>，代表所有未指定日志级别都使用 root 的 warn 级别</li></ol><blockquote><p>日志分组</p></blockquote><p>比较有用的技巧是：</p><p>将相关的logger分组在一起，统一配置。SpringBoot 也支持。比如：Tomcat 相关的日志统一设置</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>logging<span class="token punctuation">.</span>group<span class="token punctuation">.</span>tomcat<span class="token operator">=</span>org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>catalina<span class="token punctuation">,</span>org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>coyote<span class="token punctuation">,</span>org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>tomcat
logging<span class="token punctuation">.</span>level<span class="token punctuation">.</span>tomcat<span class="token operator">=</span>trace
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>SpringBoot 预定义两个组</p><table><thead><tr><th>Name</th><th>Loggers</th></tr></thead><tbody><tr><td>web</td><td>org.springframework.core.codec, org.springframework.http, org.springframework.web, org.springframework.boot.actuate.endpoint.web, org.springframework.boot.web.servlet.ServletContextInitializerBeans</td></tr><tr><td>sql</td><td>org.springframework.jdbc.core, org.hibernate.SQL, org.jooq.tools.LoggerListener</td></tr></tbody></table><blockquote><p>日志文件输出</p></blockquote><p>SpringBoot 默认只把日志写在控制台，如果想额外记录到文件，可以在application.properties中添加logging.file.name or logging.file.path配置项。</p><table><thead><tr><th>logging.file.name</th><th>logging.file.path</th><th>示例</th><th>效果</th></tr></thead><tbody><tr><td>未指定</td><td>未指定</td><td></td><td>仅控制台输出</td></tr><tr><td><strong>指定</strong></td><td>未指定</td><td>my.log</td><td>写入指定文件。可以加路径</td></tr><tr><td>未指定</td><td><strong>指定</strong></td><td>/var/log</td><td>写入指定目录，文件名为spring.log</td></tr><tr><td><strong>指定</strong></td><td><strong>指定</strong></td><td></td><td>以logging.file.name为准</td></tr></tbody></table><blockquote><p>日志文件归档和滚动切割</p></blockquote><p>归档：每天的日志单独存到一个文档中。</p><p>切割：每个文件10MB，超过大小切割成另外一个文件。</p><ol><li>每天的日志应该独立分割出来存档。如果使用logback（SpringBoot 默认整合），可以通过application.properties/yaml文件指定日志滚动规则。</li><li>如果是其他日志系统，需要自行配置（添加log4j2.xml或log4j2-spring.xml）</li><li>支持的滚动规则设置如下</li></ol><table><thead><tr><th>配置项</th><th>描述</th></tr></thead><tbody><tr><td>logging.logback.rollingpolicy.file-name-pattern</td><td>日志存档的文件名格式（默认值：${LOG_FILE}.%d{yyyy-MM-dd}.%i.gz）</td></tr><tr><td>logging.logback.rollingpolicy.clean-history-on-start</td><td>应用启动时是否清除以前存档（默认值：false）</td></tr><tr><td>logging.logback.rollingpolicy.max-file-size</td><td>存档前，每个日志文件的最大大小（默认值：10MB）</td></tr><tr><td>logging.logback.rollingpolicy.total-size-cap</td><td>日志文件被删除之前，可以容纳的最大大小（默认值：0B）。设置1GB则磁盘存储超过 1GB 日志后就会删除旧日志文件</td></tr><tr><td>logging.logback.rollingpolicy.max-history</td><td>日志文件保存的最大天数(默认值：7).</td></tr></tbody></table><blockquote><p>自定义配置</p></blockquote><p>通常我们配置 application.properties 就够了。当然也可以自定义。比如：</p><table><thead><tr><th>日志系统</th><th>自定义</th></tr></thead><tbody><tr><td>Logback</td><td>logback-spring.xml, logback-spring.groovy, logback.xml, or logback.groovy</td></tr><tr><td>Log4j2</td><td>log4j2-spring.xml or log4j2.xml</td></tr><tr><td>JDK (Java Util Logging)</td><td>logging.properties</td></tr></tbody></table><p>如果可能，建议在日志配置中使用<code>-spring</code> 变量（例如，<code>logback-spring.xml</code> 而不是 <code>logback.xml</code>）。如果使用标准配置文件，spring 无法完全控制日志初始化。最佳实战：自己要写配置，配置文件名加上 <code>xx-spring.xml</code></p><blockquote><p>切换日志组合</p></blockquote><p>先排除已有的，然后引入自己的</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-web<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>exclusions</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>exclusion</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-logging<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>exclusion</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>exclusions</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-log4j2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>log4j2支持yaml和json格式的配置文件</p><table><thead><tr><th>格式</th><th>依赖</th><th>文件名</th></tr></thead><tbody><tr><td>YAML</td><td>com.fasterxml.jackson.core:jackson-databind + com.fasterxml.jackson.dataformat:jackson-dataformat-yaml</td><td>log4j2.yaml + log4j2.yml</td></tr><tr><td>JSON</td><td>com.fasterxml.jackson.core:jackson-databind</td><td>log4j2.json + log4j2.jsn</td></tr></tbody></table><h3 id="" tabindex="-1"><a class="header-anchor" href="#" aria-hidden="true">#</a></h3><h2 id="springboot-web开发" tabindex="-1"><a class="header-anchor" href="#springboot-web开发" aria-hidden="true">#</a> springboot-web开发</h2><blockquote><p>SpringBoot的Web开发能力，由<strong>SpringMVC</strong>提供。</p></blockquote><h3 id="webmvcautoconfiguration原理" tabindex="-1"><a class="header-anchor" href="#webmvcautoconfiguration原理" aria-hidden="true">#</a> WebMvcAutoConfiguration原理</h3><h4 id="生效条件" tabindex="-1"><a class="header-anchor" href="#生效条件" aria-hidden="true">#</a> 生效条件</h4><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@AutoConfiguration</span><span class="token punctuation">(</span>after <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token class-name">DispatcherServletAutoConfiguration</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token class-name">TaskExecutionAutoConfiguration</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span>
		<span class="token class-name">ValidationAutoConfiguration</span><span class="token punctuation">.</span><span class="token keyword">class</span> <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token comment">//在这些自动配置之后</span>
<span class="token annotation punctuation">@ConditionalOnWebApplication</span><span class="token punctuation">(</span>type <span class="token operator">=</span> <span class="token class-name">Type</span><span class="token punctuation">.</span><span class="token constant">SERVLET</span><span class="token punctuation">)</span> <span class="token comment">//如果是web应用就生效，类型SERVLET、REACTIVE 响应式web</span>
<span class="token annotation punctuation">@ConditionalOnClass</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token class-name">Servlet</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token class-name">DispatcherServlet</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token class-name">WebMvcConfigurer</span><span class="token punctuation">.</span><span class="token keyword">class</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@ConditionalOnMissingBean</span><span class="token punctuation">(</span><span class="token class-name">WebMvcConfigurationSupport</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span> <span class="token comment">//容器中没有这个Bean，才生效。默认就是没有</span>
<span class="token annotation punctuation">@AutoConfigureOrder</span><span class="token punctuation">(</span><span class="token class-name">Ordered</span><span class="token punctuation">.</span><span class="token constant">HIGHEST_PRECEDENCE</span> <span class="token operator">+</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token comment">//优先级</span>
<span class="token annotation punctuation">@ImportRuntimeHints</span><span class="token punctuation">(</span><span class="token class-name">WebResourcesRuntimeHints</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">WebMvcAutoConfiguration</span> <span class="token punctuation">{</span> 
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="效果" tabindex="-1"><a class="header-anchor" href="#效果" aria-hidden="true">#</a> 效果</h4><p>WebMvcAutoConfiguration主要结构如下：</p><ul><li><p>放了两个Filter</p><ul><li><p><code>HiddenHttpMethodFilter</code>；页面表单提交Rest请求（GET、POST、PUT、DELETE）</p></li><li><p><code>FormContentFilter</code>： 表单内容Filter，GET（数据放URL后面）、POST（数据放请求体）请求可以携带数据，PUT、DELETE 的请求体数据会被忽略，这个filter则提供了该支持</p></li></ul></li><li><p>给容器中放了<code>WebMvcConfigurer</code>组件；给SpringMVC添加各种定制功能，和springboot配置的默认行为</p><ul><li><p>所有的功能最终会和配置文件进行绑定</p></li><li><p>WebMvcProperties： <code>spring.mvc</code>配置文件</p></li><li><p>WebProperties： <code>spring.web</code>配置文件</p></li><li><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span><span class="token punctuation">(</span>proxyBeanMethods <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Import</span><span class="token punctuation">(</span><span class="token class-name">EnableWebMvcConfiguration</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span> <span class="token comment">//额外导入了其他配置</span>
<span class="token annotation punctuation">@EnableConfigurationProperties</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token class-name">WebMvcProperties</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token class-name">WebProperties</span><span class="token punctuation">.</span><span class="token keyword">class</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Order</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">WebMvcAutoConfigurationAdapter</span> <span class="token keyword">implements</span> <span class="token class-name">WebMvcConfigurer</span><span class="token punctuation">,</span> <span class="token class-name">ServletContextAware</span><span class="token punctuation">{</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul></li><li><p>还有一个<strong>EnableWebMvcConfiguration类</strong>：配置一些额外功能可以看作是上一个接口功能的补充，比如：欢迎页，静态资源前缀</p></li></ul><h4 id="webmvcconfigurer接口" tabindex="-1"><a class="header-anchor" href="#webmvcconfigurer接口" aria-hidden="true">#</a> WebMvcConfigurer接口</h4><p>提供了配置SpringMVC底层的所有组件入口</p><img src="/home/assets/screenshot2024-04-0522.47.53-fcf88f5d.png" alt="screenshot2024-04-05 22.47.53" style="zoom:67%;"><h4 id="静态资源规则源码" tabindex="-1"><a class="header-anchor" href="#静态资源规则源码" aria-hidden="true">#</a> 静态资源规则源码</h4><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">addResourceHandlers</span><span class="token punctuation">(</span><span class="token class-name">ResourceHandlerRegistry</span> registry<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>resourceProperties<span class="token punctuation">.</span><span class="token function">isAddMappings</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        logger<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">&quot;Default resource handling disabled&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token function">addResourceHandler</span><span class="token punctuation">(</span>registry<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>mvcProperties<span class="token punctuation">.</span><span class="token function">getWebjarsPathPattern</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token string">&quot;classpath:/META-INF/resources/webjars/&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">addResourceHandler</span><span class="token punctuation">(</span>registry<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>mvcProperties<span class="token punctuation">.</span><span class="token function">getStaticPathPattern</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>registration<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
        registration<span class="token punctuation">.</span><span class="token function">addResourceLocations</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>resourceProperties<span class="token punctuation">.</span><span class="token function">getStaticLocations</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>servletContext <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">ServletContextResource</span> resource <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ServletContextResource</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>servletContext<span class="token punctuation">,</span> <span class="token constant">SERVLET_LOCATION</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            registration<span class="token punctuation">.</span><span class="token function">addResourceLocations</span><span class="token punctuation">(</span>resource<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>规则一：访问： <code>/webjars/**</code>路径就去 <code>classpath:/META-INF/resources/webjars/</code>下找资源.</li><li>规则二：访问： <code>/**</code>路径就去 <code>静态资源默认的四个位置找资源</code><ul><li><code>classpath:/META-INF/resources/</code></li><li><code>classpath:/resources/</code></li><li><code>classpath:/static/</code></li><li><code>classpath:/public/</code></li></ul></li><li>规则三：<strong>静态资源默认都有缓存规则的设置</strong><ul><li>所有缓存的设置，直接通过<strong>配置文件</strong>： <code>spring.web</code></li><li>cachePeriod： 缓存周期； 多久不用找服务器要新的。 默认没有，以s为单位</li><li>cacheControl： <strong>HTTP缓存</strong>控制；<a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Caching#%E6%A6%82%E8%A7%88" target="_blank" rel="noopener noreferrer">https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Caching<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><strong>useLastModified</strong>：是否使用最后一次修改。配合HTTP Cache规则</li></ul></li></ul><blockquote><p>如果浏览器访问了一个静态资源 <code>index.js</code>，如果服务这个资源没有发生变化，下次访问的时候就可以直接让浏览器用自己缓存中的东西，而不用给服务器发请求。</p></blockquote><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>registration<span class="token punctuation">.</span><span class="token function">setCachePeriod</span><span class="token punctuation">(</span><span class="token function">getSeconds</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>resourceProperties<span class="token punctuation">.</span><span class="token function">getCache</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getPeriod</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
registration<span class="token punctuation">.</span><span class="token function">setCacheControl</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>resourceProperties<span class="token punctuation">.</span><span class="token function">getCache</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getCachecontrol</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toHttpCacheControl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
registration<span class="token punctuation">.</span><span class="token function">setUseLastModified</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>resourceProperties<span class="token punctuation">.</span><span class="token function">getCache</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">isUseLastModified</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="enablewebmvcconfiguration-源码" tabindex="-1"><a class="header-anchor" href="#enablewebmvcconfiguration-源码" aria-hidden="true">#</a> EnableWebMvcConfiguration 源码</h4><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token comment">//SpringBoot 给容器中放 WebMvcConfigurationSupport 组件。</span>
<span class="token comment">//我们如果自己放了 WebMvcConfigurationSupport 组件，Boot的WebMvcAutoConfiguration都会失效。</span>
<span class="token annotation punctuation">@Configuration</span><span class="token punctuation">(</span>proxyBeanMethods <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@EnableConfigurationProperties</span><span class="token punctuation">(</span><span class="token class-name">WebProperties</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">EnableWebMvcConfiguration</span> <span class="token keyword">extends</span> <span class="token class-name">DelegatingWebMvcConfiguration</span> <span class="token keyword">implements</span> <span class="token class-name">ResourceLoaderAware</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><p><code>HandlerMapping</code>： 根据请求路径 <code> /a</code> 找那个handler能处理请求</p><ul><li><p><code>WelcomePageHandlerMapping</code>：</p><ul><li><p>访问 <code>/**</code>路径下的所有请求，都在以前四个静态资源路径下找，欢迎页也一样</p></li><li><p>找<code>index.html</code>：只要静态资源的位置有一个 <code>index.html</code>页面，项目启动默认访问</p></li></ul></li></ul></li></ul><h4 id="为什么容器中放一个webmvcconfigurer就能配置底层行为" tabindex="-1"><a class="header-anchor" href="#为什么容器中放一个webmvcconfigurer就能配置底层行为" aria-hidden="true">#</a> 为什么容器中放一个<code>WebMvcConfigurer</code>就能配置底层行为</h4><ol><li>WebMvcAutoConfiguration 是一个自动配置类，它里面有一个 <code>EnableWebMvcConfiguration</code></li><li><code>EnableWebMvcConfiguration</code>继承与 <code>DelegatingWebMvcConfiguration</code>，这两个都生效</li><li><code>DelegatingWebMvcConfiguration</code>利用 DI 把容器中 所有 <code>WebMvcConfigurer </code>注入进来</li><li>别人调用 <code>DelegatingWebMvcConfiguration</code> 的方法配置底层规则，而它调用所有 <code>WebMvcConfigurer</code>的配置底层方法。</li></ol><h4 id="webmvcconfigurationsupport" tabindex="-1"><a class="header-anchor" href="#webmvcconfigurationsupport" aria-hidden="true">#</a> WebMvcConfigurationSupport</h4><p>提供了很多的默认设置。</p><p>判断系统中是否有相应的类：如果有，就加入相应的<code>HttpMessageConverter</code></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>jackson2Present <span class="token operator">=</span> <span class="token class-name">ClassUtils</span><span class="token punctuation">.</span><span class="token function">isPresent</span><span class="token punctuation">(</span><span class="token string">&quot;com.fasterxml.jackson.databind.ObjectMapper&quot;</span><span class="token punctuation">,</span> classLoader<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span>
				<span class="token class-name">ClassUtils</span><span class="token punctuation">.</span><span class="token function">isPresent</span><span class="token punctuation">(</span><span class="token string">&quot;com.fasterxml.jackson.core.JsonGenerator&quot;</span><span class="token punctuation">,</span> classLoader<span class="token punctuation">)</span><span class="token punctuation">;</span>
jackson2XmlPresent <span class="token operator">=</span> <span class="token class-name">ClassUtils</span><span class="token punctuation">.</span><span class="token function">isPresent</span><span class="token punctuation">(</span><span class="token string">&quot;com.fasterxml.jackson.dataformat.xml.XmlMapper&quot;</span><span class="token punctuation">,</span> classLoader<span class="token punctuation">)</span><span class="token punctuation">;</span>
jackson2SmilePresent <span class="token operator">=</span> <span class="token class-name">ClassUtils</span><span class="token punctuation">.</span><span class="token function">isPresent</span><span class="token punctuation">(</span><span class="token string">&quot;com.fasterxml.jackson.dataformat.smile.SmileFactory&quot;</span><span class="token punctuation">,</span> classLoader<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="web默认配置" tabindex="-1"><a class="header-anchor" href="#web默认配置" aria-hidden="true">#</a> Web默认配置</h3><p>整合web后：</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-web<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>SpringMVC自动配置场景给我们配置了如下所有默认行为</p><ol><li><code>WebMvcAutoConfiguration</code>web场景的自动配置类 <ol><li>支持RESTful的filter：HiddenHttpMethodFilter</li><li>支持非POST请求，请求体携带数据：FormContentFilter</li><li>导入**<code>EnableWebMvcConfiguration</code>**： <ol><li><code>RequestMappingHandlerAdapter</code></li><li><code>WelcomePageHandlerMapping</code>： <strong>欢迎页功能</strong>支持（模板引擎目录、静态资源目录放index.html），项目访问/ 就默认展示这个页面.</li><li><code>RequestMappingHandlerMapping</code>：找每个请求由谁处理的映射关系</li><li><code>ExceptionHandlerExceptionResolver</code>：默认的异常解析器</li><li><code>LocaleResolver</code>：国际化解析器</li><li><code>ThemeResolver</code>：主题解析器</li><li><code>FlashMapManager</code>：临时数据共享</li><li><code>FormattingConversionService</code>： 数据格式化 、类型转化</li><li><code>Validator</code>： 数据校验<code>JSR303</code>提供的数据校验功能</li><li><code>WebBindingInitializer</code>：请求参数的封装与绑定</li><li><code>ContentNegotiationManager</code>：内容协商管理器</li></ol></li><li>**<code>WebMvcAutoConfigurationAdapter</code>**配置生效，它是一个<code>WebMvcConfigurer</code>，定义mvc底层组件 <ol><li>定义好 <code>WebMvcConfigurer</code> <strong>底层组件默认功能；</strong></li><li>视图解析器：<code>InternalResourceViewResolver</code></li><li>视图解析器：<code>BeanNameViewResolver</code>,**视图名（controller方法的返回值字符串）**就是组件名</li><li>内容协商解析器：<code>ContentNegotiatingViewResolver</code></li><li>请求上下文过滤器：<code>RequestContextFilter</code>: 任意位置直接获取当前请求</li><li>静态资源链规则</li><li><code>ProblemDetailsExceptionHandler</code>：错误详情</li><li>SpringMVC内部场景异常被它捕获：</li></ol></li><li>定义了MVC默认的底层行为: <strong><code>WebMvcConfigurer</code></strong></li></ol></li></ol><p><strong>重要：</strong></p><ul><li>如果想保持boot mvc 的默认配置，并且自定义更多的 mvc 配置，如：interceptors,formatters,view controllers 等。可以使用@Configuration注解添加一个WebMvcConfigurer 类型的配置类，并不要标注 @EnableWebMvc</li><li>如果想保持 boot mvc 的默认配置，但要自定义核心组件实例，比如：RequestMappingHandlerMapping, RequestMappingHandlerAdapter, 或ExceptionHandlerExceptionResolver，给容器中放一个 WebMvcRegistrations 组件即可</li><li>如果想全面接管 Spring MVC，@Configuration 标注一个配置类，并加上@EnableWebMvc注解，实现 WebMvcConfigurer 接口</li></ul><p><code>@ConditionalOnMissingBean(WebMvcConfigurationSupport.class)</code>从这里可以看出，只有我们没有注册该组件，springboot才会去创建他的web自动配置，他的默认配置才会生效，比如静态资源访问等等</p><p>而<code>@EnableWebMvc</code>注导入了<code>@Import({DelegatingWebMvcConfiguration.class})</code>，该类是<code>WebMvcConfigurationSupport.class</code>的子类，所以一旦我们使用了该注解，springboot为我们做的工作就不会生效了（但是处理请求之类的还是可以访问，这些不属于springboot做的工作，是springmvc做的工作）</p><h3 id="静态资源映射" tabindex="-1"><a class="header-anchor" href="#静态资源映射" aria-hidden="true">#</a> 静态资源映射</h3><h4 id="默认配置" tabindex="-1"><a class="header-anchor" href="#默认配置" aria-hidden="true">#</a> 默认配置</h4><p>静态资源映射规则在 WebMvcAutoConfiguration 中进行了定义：</p><ul><li><code>/webjars/**</code> 的所有路径 资源都在 <code>classpath:/META-INF/resources/webjars/</code></li><li><code>/**</code> 的所有路径 资源都在 <code>classpath:/META-INF/resources/</code>、<code>classpath:/resources/</code>、<code>classpath:/static/</code>、<code>classpath:/public/</code></li></ul><p>静态资源缓存</p><ul><li>所有静态资源都定义了缓存规则。【浏览器访问过一次，就会缓存一段时间】，但此功能参数无默认值 <ul><li><code>period</code>： 缓存间隔。 默认 0S；</li><li><code>cacheControl</code>：缓存控制。 默认无；</li><li><code>useLastModified</code>：是否使用lastModified头。 默认 false；</li></ul></li></ul><p>欢迎页</p><ul><li><p>欢迎页规则在 WebMvcAutoConfiguration 中进行了定义：</p><ul><li><p>在<strong>静态资源</strong>目录下找 index.html</p></li><li><p>没有就在 templates下找index模板页</p></li></ul></li></ul><p>Favicon</p><ul><li>在静态资源目录下找 favicon.ico</li></ul><h4 id="自定义配置" tabindex="-1"><a class="header-anchor" href="#自定义配置" aria-hidden="true">#</a> 自定义配置</h4><p>配置文件</p><div class="language-properties line-numbers-mode" data-ext="properties"><pre class="language-properties"><code><span class="token comment">#开启静态资源映射规则,默认true</span>
<span class="token key attr-name">spring.web.resources.add-mappings</span><span class="token punctuation">=</span><span class="token value attr-value">true</span>

<span class="token comment">#设置缓存</span>
<span class="token comment">#spring.web.resources.cache.period=3600</span>
<span class="token comment">##缓存详细合并项控制，覆盖period配置：</span>
<span class="token comment">## 浏览器第一次请求服务器，服务器告诉浏览器此资源缓存7200秒，7200秒以内的所有此资源访问不用发给服务器请求，7200秒以后发请求给服务器</span>
<span class="token key attr-name">spring.web.resources.cache.cachecontrol.max-age</span><span class="token punctuation">=</span><span class="token value attr-value">7200</span>
<span class="token comment">#使用资源 last-modified 时间，来对比服务器和浏览器的资源是否相同没有变化。相同返回 304</span>
<span class="token key attr-name">spring.web.resources.cache.use-last-modified</span><span class="token punctuation">=</span><span class="token value attr-value">true</span>

<span class="token comment">#自定义静态资源文件夹位置</span>
<span class="token key attr-name">spring.web.resources.static-locations</span><span class="token punctuation">=</span><span class="token value attr-value">classpath:/a/,classpath:/b/,classpath:/static/</span>

<span class="token comment">#2、 spring.mvc</span>
<span class="token comment">## 2.1. 自定义webjars路径前缀</span>
<span class="token key attr-name">spring.mvc.webjars-path-pattern</span><span class="token punctuation">=</span><span class="token value attr-value">/wj/**</span>
<span class="token comment">## 2.2. 静态资源访问路径前缀，浏览器访问时，需要加static</span>
<span class="token key attr-name">spring.mvc.static-path-pattern</span><span class="token punctuation">=</span><span class="token value attr-value">/static/**</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>配置类（注意不要使用@EnableWebMvc）</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span> <span class="token comment">// 这是一个配置类,直接继承 WebMvcConfigurer</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyConfig</span> <span class="token keyword">implements</span> <span class="token class-name">WebMvcConfigurer</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">addResourceHandlers</span><span class="token punctuation">(</span><span class="token class-name">ResourceHandlerRegistry</span> registry<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//保留以前规则</span>
        <span class="token comment">//自己写新的规则。</span>
        registry<span class="token punctuation">.</span><span class="token function">addResourceHandler</span><span class="token punctuation">(</span><span class="token string">&quot;/static/**&quot;</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">addResourceLocations</span><span class="token punctuation">(</span><span class="token string">&quot;classpath:/a/&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;classpath:/b/&quot;</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">setCacheControl</span><span class="token punctuation">(</span><span class="token class-name">CacheControl</span><span class="token punctuation">.</span><span class="token function">maxAge</span><span class="token punctuation">(</span><span class="token number">1180</span><span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span><span class="token constant">SECONDS</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>或者</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span> <span class="token comment">// 这是一个配置类,给容器中放一个 WebMvcConfigurer 组件，就能自定义底层</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyConfig</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">WebMvcConfigurer</span> <span class="token function">webMvcConfigurer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">WebMvcConfigurer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token annotation punctuation">@Override</span>
            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">addResourceHandlers</span><span class="token punctuation">(</span><span class="token class-name">ResourceHandlerRegistry</span> registry<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                registry<span class="token punctuation">.</span><span class="token function">addResourceHandler</span><span class="token punctuation">(</span><span class="token string">&quot;/static/**&quot;</span><span class="token punctuation">)</span>
                        <span class="token punctuation">.</span><span class="token function">addResourceLocations</span><span class="token punctuation">(</span><span class="token string">&quot;classpath:/a/&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;classpath:/b/&quot;</span><span class="token punctuation">)</span>
                        <span class="token punctuation">.</span><span class="token function">setCacheControl</span><span class="token punctuation">(</span><span class="token class-name">CacheControl</span><span class="token punctuation">.</span><span class="token function">maxAge</span><span class="token punctuation">(</span><span class="token number">1180</span><span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span><span class="token constant">SECONDS</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="路径匹配规则" tabindex="-1"><a class="header-anchor" href="#路径匹配规则" aria-hidden="true">#</a> 路径匹配规则</h3><blockquote><p><strong>Spring5.3</strong> 之后加入了更多的请求路径匹配的实现策略；</p><p>以前只支持 AntPathMatcher 策略, 现在提供了 <strong>PathPatternParser</strong> 策略。并且可以让我们指定到底使用那种策略。</p></blockquote><p>Ant 风格的路径模式语法具有以下规则：</p><ul><li>*：表示<strong>任意数量</strong>的字符。</li><li>?：表示任意<strong>一个字符</strong>。</li><li>：表示任意数量的<strong>目录</strong>。</li><li>{}：表示一个命名的模式<strong>占位符</strong>。</li><li>[]：表示<strong>字符集合</strong>，例如[a-z]表示小写字母。</li></ul><p>例如：</p><ul><li>*.html 匹配任意名称，扩展名为.html的文件。</li><li>/folder1/* / *.java 匹配在folder1目录下的任意两级目录下的.java文件。</li><li>/folder2/** / *.jsp 匹配在folder2目录下任意目录深度的.jsp文件。</li><li>/{type}/{id}.html 匹配任意文件名为{id}.html，在任意命名的{type}目录下的文件。</li></ul><p>注意：Ant 风格的路径模式语法中的特殊字符需要转义，如：</p><ul><li>要匹配文件路径中的星号，则需要转义为\ \ *。</li><li>要匹配文件路径中的问号，则需要转义为\ \ ?。</li></ul><p>AntPathMatcher 与 PathPatternParser</p><ul><li>PathPatternParser 在 jmh 基准测试下，有 6~8 倍吞吐量提升，降低 30%~40%空间分配率</li><li>PathPatternParser 兼容 AntPathMatcher 语法，并支持更多类型的路径模式</li><li>PathPatternParser &quot;**&quot; 多段匹配的支持仅允许在模式末尾使用</li></ul><p>总结：</p><ul><li>使用默认的路径匹配规则，是由 PathPatternParser 提供的</li><li>如果路径中间需要有 **，替换成ant风格路径</li></ul><div class="language-properties line-numbers-mode" data-ext="properties"><pre class="language-properties"><code><span class="token comment"># 改变路径匹配策略：</span>
<span class="token comment"># ant_path_matcher 老版策略；</span>
<span class="token comment"># path_pattern_parser 新版策略；</span>
<span class="token key attr-name">spring.mvc.pathmatch.matching-strategy</span><span class="token punctuation">=</span><span class="token value attr-value">ant_path_matcher</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="内容协商" tabindex="-1"><a class="header-anchor" href="#内容协商" aria-hidden="true">#</a> 内容协商</h3><h4 id="概念-1" tabindex="-1"><a class="header-anchor" href="#概念-1" aria-hidden="true">#</a> 概念</h4><blockquote><p><code>@ResponseBody</code>由<code>HttpMessageConverter</code>处理</p></blockquote><p><strong>SpringBoot 多端内容适配</strong>。</p><ul><li>基于请求头内容协商：（默认开启）</li><li>客户端向服务端发送请求，携带HTTP标准的<strong>Accept请求头</strong>。</li><li><strong>Accept</strong>: <code>application/json</code>、<code>text/xml</code>、<code>text/yaml</code></li><li>服务端根据客户端<strong>请求头期望的数据类型</strong>进行<strong>动态返回</strong></li></ul><p>基于请求参数内容协商**：（需要开启）**</p><ul><li>发送请求 GET /projects/spring-boot?format=json</li><li>匹配到 @GetMapping(&quot;/projects/spring-boot&quot;)</li><li>根据<strong>参数协商</strong>，优先返回 json 类型数据【<strong>需要开启参数匹配设置</strong>】</li><li>发送请求 GET /projects/spring-boot?format=xml,优先返回 xml 类型数据</li></ul><h4 id="xml" tabindex="-1"><a class="header-anchor" href="#xml" aria-hidden="true">#</a> xml</h4><p>请求同一个接口，可以返回json和xml不同格式数据</p><p>引入支持写出xml内容依赖</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.fasterxml.jackson.dataformat<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>jackson-dataformat-xml<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>标注注解</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@JacksonXmlRootElement</span>  <span class="token comment">// 可以写出为xml文档</span>
<span class="token annotation punctuation">@Data</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>
  <span class="token keyword">private</span> <span class="token class-name">Long</span> id<span class="token punctuation">;</span>
  <span class="token keyword">private</span> <span class="token class-name">String</span> userName<span class="token punctuation">;</span>
  <span class="token keyword">private</span> <span class="token class-name">String</span> email<span class="token punctuation">;</span>
  <span class="token keyword">private</span> <span class="token class-name">Integer</span> age<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>开启基于请求参数的内容协商</p><div class="language-properties line-numbers-mode" data-ext="properties"><pre class="language-properties"><code><span class="token comment"># 开启基于请求参数的内容协商功能。 默认参数名：format。 默认此功能不开启</span>
<span class="token key attr-name">spring.mvc.contentnegotiation.favor-parameter</span><span class="token punctuation">=</span><span class="token value attr-value">true</span>
<span class="token comment"># 指定内容协商时使用的参数名。默认是 format</span>
<span class="token key attr-name">spring.mvc.contentnegotiation.parameter-name</span><span class="token punctuation">=</span><span class="token value attr-value">type</span>
<span class="token key attr-name">大多数</span> <span class="token value attr-value">MediaType 都是开箱即用的。也可以自定义内容类型，这种就需要自己写HttpMessageConveter</span>
<span class="token key attr-name">spring.mvc.contentnegotiation.media-types.yaml</span><span class="token punctuation">=</span><span class="token value attr-value">text/yaml</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><img src="/home/assets/screenshot2024-04-0616.52.06-5af5e3ad.png" alt="screenshot2024-04-06 16.52.06" style="zoom:50%;"><h4 id="yaml" tabindex="-1"><a class="header-anchor" href="#yaml" aria-hidden="true">#</a> Yaml</h4><p>导入依赖</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.fasterxml.jackson.dataformat<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>jackson-dataformat-yaml<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>编写配置</p><div class="language-properties line-numbers-mode" data-ext="properties"><pre class="language-properties"><code><span class="token comment">#新增一种媒体类型</span>
<span class="token key attr-name">spring.mvc.contentnegotiation.media-types.yaml</span><span class="token punctuation">=</span><span class="token value attr-value">text/yaml</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>增加HttpMessageConverter组件，专门负责把对象写出为yaml格式，HttpMessageConverter的示例写法</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyYamlHttpMessageConverter</span> <span class="token keyword">extends</span> <span class="token class-name">AbstractHttpMessageConverter</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token class-name">ObjectMapper</span> objectMapper <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span> <span class="token comment">//把对象转成yaml</span>

    <span class="token keyword">public</span> <span class="token class-name">MyYamlHttpMessageConverter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token comment">//告诉SpringBoot这个MessageConverter支持哪种媒体类型  //媒体类型</span>
        <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">MediaType</span><span class="token punctuation">(</span><span class="token string">&quot;text&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;yaml&quot;</span><span class="token punctuation">,</span> <span class="token class-name">Charset</span><span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span><span class="token string">&quot;UTF-8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">YAMLFactory</span> factory <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">YAMLFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">disable</span><span class="token punctuation">(</span><span class="token class-name">YAMLGenerator<span class="token punctuation">.</span>Feature</span><span class="token punctuation">.</span><span class="token constant">WRITE_DOC_START_MARKER</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>objectMapper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ObjectMapper</span><span class="token punctuation">(</span>factory<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">boolean</span> <span class="token function">supports</span><span class="token punctuation">(</span><span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> clazz<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//只要是对象类型，不是基本类型</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>  <span class="token comment">//@RequestBody</span>
    <span class="token keyword">protected</span> <span class="token class-name">Object</span> <span class="token function">readInternal</span><span class="token punctuation">(</span><span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> clazz<span class="token punctuation">,</span> <span class="token class-name">HttpInputMessage</span> inputMessage<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span><span class="token punctuation">,</span> <span class="token class-name">HttpMessageNotReadableException</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span> <span class="token comment">//@ResponseBody 把对象怎么写出去</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">writeInternal</span><span class="token punctuation">(</span><span class="token class-name">Object</span> methodReturnValue<span class="token punctuation">,</span> <span class="token class-name">HttpOutputMessage</span> outputMessage<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span><span class="token punctuation">,</span> <span class="token class-name">HttpMessageNotWritableException</span> <span class="token punctuation">{</span>
        <span class="token comment">//try-with写法，自动关流</span>
        <span class="token keyword">try</span><span class="token punctuation">(</span><span class="token class-name">OutputStream</span> os <span class="token operator">=</span> outputMessage<span class="token punctuation">.</span><span class="token function">getBody</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>objectMapper<span class="token punctuation">.</span><span class="token function">writeValue</span><span class="token punctuation">(</span>os<span class="token punctuation">,</span>methodReturnValue<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="错误处理" tabindex="-1"><a class="header-anchor" href="#错误处理" aria-hidden="true">#</a> 错误处理</h3><p><strong>错误处理的自动配置</strong>都在<code>ErrorMvcAutoConfiguration</code>中，两大核心机制：</p><ul><li>SpringBoot 会自适应处理错误，响应页面或JSON数据</li><li>SpringMVC的错误处理机制依然保留，MVC处理不了，才会交给boot进行处理</li></ul><img src="/home/assets/1681723795095-828d2034-1e6c-4d98-8e47-573dd6b5463b-4d3ad64b.svg" alt="未命名绘图.svg" style="zoom:50%;"><blockquote><p>前后端分离项目：使用@ControllerAdvice + @ExceptionHandler 进行统一异常处理，返回json数据即可</p></blockquote><h2 id="profiles环境" tabindex="-1"><a class="header-anchor" href="#profiles环境" aria-hidden="true">#</a> Profiles环境</h2><h3 id="注解使用" tabindex="-1"><a class="header-anchor" href="#注解使用" aria-hidden="true">#</a> 注解使用</h3><p>容器中所有组件均可以使用<code>@Profile</code>注解来标记该组件生效的环境，如果不配置，默认是所有环境都生效</p><h3 id="环境激活" tabindex="-1"><a class="header-anchor" href="#环境激活" aria-hidden="true">#</a> 环境激活</h3><div class="language-properties line-numbers-mode" data-ext="properties"><pre class="language-properties"><code><span class="token comment"># 存在一个默认环境default</span>
<span class="token comment"># spring.profiles.active 和spring.profiles.default只能写在主配置文件中</span>
<span class="token key attr-name">spring.profiles.active</span><span class="token punctuation">=</span><span class="token value attr-value">production,hsqldb</span>
<span class="token comment"># 包含环境</span>
<span class="token key attr-name">spring.profiles.include[0]</span><span class="token punctuation">=</span><span class="token value attr-value">common</span>
<span class="token key attr-name">spring.profiles.include[1]</span><span class="token punctuation">=</span><span class="token value attr-value">local</span>
<span class="token key attr-name">spring.profiles.include</span><span class="token punctuation">=</span><span class="token value attr-value">common,local</span>
<span class="token comment"># 生效的环境 = 激活的环境/默认环境  + 包含的环境</span>
<span class="token comment"># 基础的配置mybatis、log、xxx：写到包含环境中;需要动态切换变化的 db、redis：写到激活的环境中</span>
<span class="token comment"># 环境分组</span>
<span class="token key attr-name">spring.profiles.group.prod[0]</span><span class="token punctuation">=</span><span class="token value attr-value">db</span>
<span class="token key attr-name">spring.profiles.group.prod[1]</span><span class="token punctuation">=</span><span class="token value attr-value">mq</span>
<span class="token comment"># 使用spring.profiles.active=prod ，就会激活prod，db，mq配置文件</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="profile配置文件" tabindex="-1"><a class="header-anchor" href="#profile配置文件" aria-hidden="true">#</a> Profile配置文件</h3><p>优先级由高到低，前面覆盖后面</p><ul><li><p>命令行 &gt; 包外config直接子目录 &gt; 包外config目录 &gt; 包外根目录 &gt; 包内目录</p></li><li><p>同级比较：</p><ul><li><p>profile配置 &gt; 默认配置</p></li><li><p>properties配置 &gt; yaml配置</p></li></ul></li></ul><img src="/home/assets/1682073869709-2cba18c8-55bd-4bf1-a9df-ac784e30d89a-719078e1.svg" alt="未命名绘图.svg" style="zoom:67%;"><h2 id="核心原理" tabindex="-1"><a class="header-anchor" href="#核心原理" aria-hidden="true">#</a> 核心原理</h2><h3 id="springboot生命周期" tabindex="-1"><a class="header-anchor" href="#springboot生命周期" aria-hidden="true">#</a> Springboot生命周期</h3><img src="/home/assets/screenshot2024-04-126.54.18-1dc3d020.png" alt="screenshot2024-04-12 16.54.18" style="zoom:33%;"><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * Listener先要从 META-INF/spring.factories 读到
 *
 * 1、引导： 利用 BootstrapContext 引导整个项目启动
 *      starting：              应用开始，SpringApplication的run方法一调用，只要有了 BootstrapContext 就执行
 *      environmentPrepared：   环境准备好（把启动参数等绑定到环境变量中），但是ioc还没有创建；【调一次】
 * 2、启动：
 *      contextPrepared：       ioc容器创建并准备好，但是sources（主配置类）没加载。关闭引导上下文；组件都没创建【调一次】
 *      contextLoaded：         ioc容器加载。主配置类加载进去了。但是ioc容器还没刷新（bean没创建）。
 *      =======截止以前，ioc容器里面还没造bean=======
 *      started：               ioc容器刷新了（所有bean造好了），但是 runner 没调用。
 *      ready:                  ioc容器刷新了（所有bean造好了），所有 runner 调用完了。
 * 3、运行
 *     以前步骤都正确执行，代表容器running。
 */</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>如何监听生命周期：自定义<code>SpringApplicationRunListener</code>来<strong>监听事件</strong>；</p><ol><li>编写<code>SpringApplicationRunListener</code> <strong>实现类</strong></li><li>在 <code>META-INF/spring.factories</code> 中配置 <code>org.springframework.boot.SpringApplicationRunListener=com.example.springboot_study.config.Config</code>，还可以指定一个<strong>有参构造器</strong>，接受两个参数<code>(SpringApplication application, String[] args)</code></li></ol><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Config</span> <span class="token keyword">implements</span> <span class="token class-name">SpringApplicationRunListener</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">starting</span><span class="token punctuation">(</span><span class="token class-name">ConfigurableBootstrapContext</span> bootstrapContext<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">SpringApplicationRunListener</span><span class="token punctuation">.</span><span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">starting</span><span class="token punctuation">(</span>bootstrapContext<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">environmentPrepared</span><span class="token punctuation">(</span><span class="token class-name">ConfigurableBootstrapContext</span> bootstrapContext<span class="token punctuation">,</span> <span class="token class-name">ConfigurableEnvironment</span> environment<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">SpringApplicationRunListener</span><span class="token punctuation">.</span><span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">environmentPrepared</span><span class="token punctuation">(</span>bootstrapContext<span class="token punctuation">,</span> environment<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">contextPrepared</span><span class="token punctuation">(</span><span class="token class-name">ConfigurableApplicationContext</span> context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">SpringApplicationRunListener</span><span class="token punctuation">.</span><span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">contextPrepared</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">contextLoaded</span><span class="token punctuation">(</span><span class="token class-name">ConfigurableApplicationContext</span> context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">SpringApplicationRunListener</span><span class="token punctuation">.</span><span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">contextLoaded</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">started</span><span class="token punctuation">(</span><span class="token class-name">ConfigurableApplicationContext</span> context<span class="token punctuation">,</span> <span class="token class-name">Duration</span> timeTaken<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">SpringApplicationRunListener</span><span class="token punctuation">.</span><span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">started</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> timeTaken<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">ready</span><span class="token punctuation">(</span><span class="token class-name">ConfigurableApplicationContext</span> context<span class="token punctuation">,</span> <span class="token class-name">Duration</span> timeTaken<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">SpringApplicationRunListener</span><span class="token punctuation">.</span><span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">ready</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> timeTaken<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">failed</span><span class="token punctuation">(</span><span class="token class-name">ConfigurableApplicationContext</span> context<span class="token punctuation">,</span> <span class="token class-name">Throwable</span> exception<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">SpringApplicationRunListener</span><span class="token punctuation">.</span><span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">failed</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> exception<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// 他就会自动加载该类，并在相应的事件调用相应的函数</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="springboot事件" tabindex="-1"><a class="header-anchor" href="#springboot事件" aria-hidden="true">#</a> springboot事件</h3><p>sprinboot除了有生命周期，还有事件机制，两者是同时运行的</p><p>和生命周期同样操作即可，这样可以监听所有的事件</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyListener</span> <span class="token keyword">implements</span> <span class="token class-name">ApplicationListener</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onApplicationEvent</span><span class="token punctuation">(</span><span class="token class-name">ApplicationEvent</span> event<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// spring.factories</span>
<span class="token comment">// org.springframework.context.ApplicationListener=com.example.springboot_study.config.MyListener</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>9大事件触发顺序&amp;时机</p><ol><li><code>ApplicationStartingEvent</code>：应用启动但未做任何事情, 除过注册listeners and initializers.</li><li><code>ApplicationEnvironmentPreparedEvent</code>： Environment 准备好，但context 未创建.</li><li><code>ApplicationContextInitializedEvent</code>: ApplicationContext 准备好，ApplicationContextInitializers 调用，但是任何bean未加载</li><li><code>ApplicationPreparedEvent</code>： 容器刷新之前，bean定义信息加载</li><li><code>ApplicationStartedEvent</code>： 容器刷新完成， runner未调用</li></ol><p>=========以下就开始插入了<strong>探针机制</strong>============</p><ol><li><code>AvailabilityChangeEvent</code>： <code>LivenessState.CORRECT</code>应用存活； <strong>存活探针</strong></li><li><code>ApplicationReadyEvent</code>: 任何runner被调用</li><li><code>AvailabilityChangeEvent</code>：<code>ReadinessState.ACCEPTING_TRAFFIC</code><strong>就绪探针</strong>，可以接请求</li><li><code>ApplicationFailedEvent </code>：启动出错</li></ol><p><img src="/home/assets/1681829576515-f8e3e993-f696-4d9d-9cdd-76ba3ba396c3-90b90a1f.png" alt="img"></p><h3 id="自定义事件驱动开发" tabindex="-1"><a class="header-anchor" href="#自定义事件驱动开发" aria-hidden="true">#</a> 自定义事件驱动开发</h3><blockquote><p>自定义事件</p></blockquote><p><code>LoginSuccessEvent</code>定义一个事件类，实现<code>ApplicationEvent</code>即可，只需要在该类中存储数据即可</p><blockquote><p>定义事件发布者</p></blockquote><p>这里可以选择实现<code>ApplicationEventPublisherAware</code>接口，也可以选择直接使用注解自动注入<code>ApplicationEventPublisher</code></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Service</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">EventPublisher</span> <span class="token keyword">implements</span> <span class="token class-name">ApplicationEventPublisherAware</span> <span class="token punctuation">{</span>

    <span class="token doc-comment comment">/**
     * 底层发送事件用的组件，SpringBoot会通过ApplicationEventPublisherAware接口自动注入给我们
     * 事件是广播出去的。所有监听这个事件的监听器都可以收到
     */</span>
    <span class="token class-name">ApplicationEventPublisher</span> applicationEventPublisher<span class="token punctuation">;</span>

    <span class="token doc-comment comment">/**
     * 所有事件都可以发
     * <span class="token keyword">@param</span> <span class="token parameter">event</span>
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">sendEvent</span><span class="token punctuation">(</span><span class="token class-name">ApplicationEvent</span> event<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//调用底层API发送事件</span>
        applicationEventPublisher<span class="token punctuation">.</span><span class="token function">publishEvent</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * 会被自动调用，把真正发事件的底层组组件给我们注入进来
     * <span class="token keyword">@param</span> <span class="token parameter">applicationEventPublisher</span> event publisher to be used by this object
     */</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setApplicationEventPublisher</span><span class="token punctuation">(</span><span class="token class-name">ApplicationEventPublisher</span> applicationEventPublisher<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>applicationEventPublisher <span class="token operator">=</span> applicationEventPublisher<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>事件订阅者</p></blockquote><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Service</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CouponService</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Order</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment">// 	使用该注解，可以设置事件订阅者的处理优先级</span>
    <span class="token annotation punctuation">@EventListener</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onEvent</span><span class="token punctuation">(</span><span class="token class-name">LoginSuccessEvent</span> loginSuccessEvent<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;===== CouponService ====感知到事件&quot;</span><span class="token operator">+</span>loginSuccessEvent<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">UserEntity</span> source <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">UserEntity</span><span class="token punctuation">)</span> loginSuccessEvent<span class="token punctuation">.</span><span class="token function">getSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">sendCoupon</span><span class="token punctuation">(</span>source<span class="token punctuation">.</span><span class="token function">getUsername</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">sendCoupon</span><span class="token punctuation">(</span><span class="token class-name">String</span> username<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>username <span class="token operator">+</span> <span class="token string">&quot; 随机得到了一张优惠券&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// 也可以选择实现接口</span>
<span class="token annotation punctuation">@Component</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CouponService</span> <span class="token keyword">implements</span> <span class="token class-name">ApplicationListener</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">LoginSuccessEvent</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onApplicationEvent</span><span class="token punctuation">(</span><span class="token class-name">LoginSuccessEvent</span> event<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Received custom event - &quot;</span> <span class="token operator">+</span> event<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>触发事件</p></blockquote><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Autowired</span>
<span class="token keyword">private</span> <span class="token class-name">EventPublisher</span> eventPublisher<span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">sendEvent</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    eventPublisher<span class="token punctuation">.</span><span class="token function">sendEvent</span><span class="token punctuation">(</span>xxxx<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="springbootapplication" tabindex="-1"><a class="header-anchor" href="#springbootapplication" aria-hidden="true">#</a> SpringBootApplication</h3><p>1、@SpringBootConfiguration</p><p>就是： @Configuration ，容器中的组件，配置类。spring ioc启动就会加载创建这个类对象</p><p>2、@EnableAutoConfiguration：开启自动配置</p><p>开启自动配置，包含下面两个注解</p><p>@AutoConfigurationPackage：扫描主程序包：加载自己的组件</p><ul><li>利用 <code>@Import(AutoConfigurationPackages.Registrar.class)</code> 想要给容器中导入组件。</li><li>把主程序所在的<strong>包</strong>的所有组件导入进来。</li></ul><p>@Import(AutoConfigurationImportSelector.class)：加载所有自动配置类：加载starter导入的组件</p><blockquote><p>扫描SPI文件：<code>META-INF/spring/org.springframework.boot.autoconfigure.AutoConfiguration.imports</code>，以前都是放在spring.factories文件中，现在单独抽取了一个自动配置类文件</p></blockquote><p>3、@ComponentScan</p><p>组件扫描：排除一些组件（哪些不要）</p><p>排除前面已经扫描进来的<code>配置类</code>、和<code>自动配置类</code>。</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@ComponentScan</span><span class="token punctuation">(</span>excludeFilters <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token annotation punctuation">@Filter</span><span class="token punctuation">(</span>type <span class="token operator">=</span> <span class="token class-name">FilterType</span><span class="token punctuation">.</span><span class="token constant">CUSTOM</span><span class="token punctuation">,</span> classes <span class="token operator">=</span> <span class="token class-name">TypeExcludeFilter</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token annotation punctuation">@Filter</span><span class="token punctuation">(</span>type <span class="token operator">=</span> <span class="token class-name">FilterType</span><span class="token punctuation">.</span><span class="token constant">CUSTOM</span><span class="token punctuation">,</span> classes <span class="token operator">=</span> <span class="token class-name">AutoConfigurationExcludeFilter</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>完整流程</p><img src="/home/assets/1682569555020-b6cbc750-3171-44c6-810f-1c59e590b792-259cac9a.svg" alt="img" style="zoom:67%;"><h3 id="自定义starter" tabindex="-1"><a class="header-anchor" href="#自定义starter" aria-hidden="true">#</a> 自定义starter</h3><ol><li><p>创建<code>自定义starter</code>项目，引入<code>spring-boot-starter</code>基础依赖</p></li><li><p>编写模块功能，引入模块所有需要的依赖。</p></li><li><p>编写<code>xxxAutoConfiguration</code>自动配置类，帮其他项目导入这个模块需要的所有组件</p></li><li><p>编写配置文件<code>META-INF/spring/org.springframework.boot.autoconfigure.AutoConfiguration.imports</code>指定启动需要加载的自动配置</p></li><li><p>其他项目引入即可使用</p></li></ol><blockquote><p>1、配置映射</p></blockquote><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@ConfigurationProperties</span><span class="token punctuation">(</span>prefix <span class="token operator">=</span> <span class="token string">&quot;robot&quot;</span><span class="token punctuation">)</span>  <span class="token comment">//此属性类和配置文件指定前缀绑定</span>
<span class="token annotation punctuation">@Component</span>
<span class="token annotation punctuation">@Data</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RobotProperties</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> age<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> email<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>倒入配置提示包</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token comment">&lt;!--        导入配置处理器，配置文件自定义的properties配置都会有提示--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-configuration-processor<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>optional</span><span class="token punctuation">&gt;</span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>optional</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>2、编写业务代码</p></blockquote><blockquote><p>3、编写RobotAutoConfiguration类</p><p>这里建议采用@EnableConfigurationProperties(RobotProperties.class)，然后在RobotProperties类中不使用@Component注解了</p></blockquote><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Import</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token comment">/*导入所有的bean*/</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RobotAutoConfiguration</span> <span class="token punctuation">{</span>
  <span class="token comment">// 也可以使用@bean导入</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>到这一步，就可以在别的工程中引入改starter，然后使用@Import注解导入<code>RobotAutoConfiguration</code>配置类即可</p><p>但这样太麻烦</p><blockquote><p>添加@Enablexxx机制</p><p>创建自定义注解，自己导入<code>RobotAutoConfiguration</code>配置类</p></blockquote><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Retention</span><span class="token punctuation">(</span><span class="token class-name">RetentionPolicy</span><span class="token punctuation">.</span><span class="token constant">RUNTIME</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Target</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token class-name">ElementType</span><span class="token punctuation">.</span><span class="token constant">TYPE</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Documented</span>
<span class="token annotation punctuation">@Import</span><span class="token punctuation">(</span><span class="token class-name">RobotAutoConfiguration</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token annotation punctuation">@interface</span> <span class="token class-name">EnableRobot</span> <span class="token punctuation">{</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>使用的时候加上一个<code>@EnableRobot</code>注解就好了，这样仍然很麻烦，下面做到自动化</p><blockquote><p>依赖SpringBoot的SPI机制</p><p>创建META-INF/spring/org.springframework.boot.autoconfigure.AutoConfiguration.imports 文件，编写好自动配置类的全类名即可</p><p>项目启动，自动加载自动配置类 perfect</p></blockquote></div><!--[--><!--]--></div><footer class="page-meta"><!----><div class="meta-item last-updated"><span class="meta-item-label">Last Updated: </span><!----></div><div class="meta-item contributors"><span class="meta-item-label">Contributors: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: 1743760069@qq.com">liushun-ing</span><!----><!--]--><!--]--></span></div></footer><nav class="page-nav"><p class="inner"><span class="prev"><a href="/home/trivia/spring/spring_annotation.html" class="" aria-label="Spring Annotation"><!--[--><!--]--> Spring Annotation <!--[--><!--]--></a></span><!----></p></nav><!--[--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script type="module" src="/home/assets/app-00b5ba62.js" defer></script>
  </body>
</html>
